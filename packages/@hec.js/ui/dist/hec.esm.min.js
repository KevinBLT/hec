function T(t){let r=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let e of r)if(e[1].includes("=")){let a=e[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=e[1];return n}var v={};var S=new WeakMap,E=t=>S.get(t),ht=t=>S.delete(t),j=t=>S.has(t),A=(t,r)=>{let n=E(t);n&&typeof n=="object"?S.set(t,Object.assign(n,r)):S.set(t,r)},d=t=>typeof t=="function"?d(t()):t;function p(t,r){let n=r.split(".");if(!r)return t;for(let e of n){if(["state"].includes(e)&&t?.state)return t[e];if(m(t)){let a=t()?.[e];if(m(a)){let o=new AbortController,s=h(a());a.subscribe({next:s},{signal:o.signal});let c=i=>{o.abort(),m(i[e])?(o=new AbortController,i[e].subscribe({next:s},{signal:o.signal}),s(i[e]())):s(i[e])};t.subscribe({next:c}),t=s}else t=t.map(o=>o&&o[e])}else if(typeof t=="function")t=d(t);else if(typeof t[e]<"u")typeof t[e]=="function"&&!m(t[e])?t=t[e].bind(t):t=t[e];else return}return t}function B(t,r){let n=r.split(".");if(!r)return!1;for(let e of n){if(["loading","error"].includes(e)&&t?.loading&&t?.error)return t[e];if(typeof t=="function")t=d(t);else if(typeof t[e]<"u")t=t[e];else return!1}return!0}var I={items:new Map,setItem(t,r){this.items.set(t,r.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},k=new Map;function at(t){try{let r=window[t+"Storage"];return typeof r.length=="number"?r:I}catch{return I}}window.addEventListener("storage",t=>{if(!k.has(t.key))return;let r=k.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&r.update(JSON.parse(n))});function h(t=null,r={}){if(r.id&&k.has(r.id))return k.get(r.id);let n=[],e=r.storage&&at(r.storage),a=i=>{t=i,e&&e.setItem(r.id,JSON.stringify(t));for(let l of n)l.next(t)};function o(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let s=(i,l=null)=>{n.push(i),l?.signal.addEventListener("abort",()=>{let u=n.indexOf(i);u>-1&&n.splice(u,1)},{once:!0})};if(e){let i=e.getItem(r.id);a(typeof i=="string"&&i!=="undefined"?JSON.parse(i):t)}let c=Object.assign(o,{id:r.id,storage:r.storage,toString:()=>t.toString(),set:i=>t=i,update:a,subscribe:s,map:i=>{let l=h(i(t)),u=new AbortController,w=l.subscribe;return s({next:f=>l(i(f))},{signal:u.signal}),Object.assign(l,{set:()=>null,subscribe:(f,y)=>{w(f,y),y?.signal.addEventListener("abort",()=>u.abort())}})},filter:i=>{let l=h(i(t)?t:null);return s({next:u=>i(u)?l(u):null}),Object.assign(l,{set:()=>null})}});return r.id&&k.set(r.id,c),c}function st(t,r=[],n=null){for(let e of r)e.subscribe({next:()=>n=t(n)});return t(n)}function xt(t,r=[],n=null){let e=h(null);return e(st(a=>e(t(a)),r,n)),e}function ot(t,r=null){let n=h(r),e=h("pending"),a=async()=>{try{e("pending"),n(await t()),e("loaded"),delete n.error}catch(o){e("error"),n.error=o}return n()};return a(),Object.assign(n,{state:e,refetch:a})}function yt(t,r,n=null){let e=ot(()=>r(d(t)),n);return m(t)&&t.subscribe({next:()=>e.refetch()}),e}var m=t=>t&&t.subscribe;var it=h({}),L=h(location.pathname);var g=document.querySelector('head meta[name="route"]');g||(g=document.createElement("meta"),g.name="route",g.content=location.pathname,document.head.append(g));var N=()=>{g.content="",L(location.pathname),it(Object.fromEntries(new URLSearchParams(location.search))),g.content=g.content||location.pathname};window.addEventListener("popstate",N);window.addEventListener("hashchange",N);var ct=window.history.pushState,lt=window.history.replaceState;window.history.pushState=function(r,n,e){ct.call(window.history,r,n,e),N()};window.history.replaceState=function(r,n,e){lt.call(window.history,r,n,e),N()};var M=new WeakMap,ut=new MutationObserver(t=>{for(let r of t)M.has(r.target)&&M.get(r.target)()}),R={select:"[data-match]",run:t=>{let r=t.dataset.match,n=o=>o.replace(/index\.*[a-z0-9]*$/gm,"");function e(){return n(new URL(t.dataset.route||t.getAttribute("href"),location.href).pathname)}let a=()=>{e()==n(location.pathname)?t.classList.add(r):t.classList.remove(r)};L.subscribe({next:a}),M.set(t,a),ut.observe(t,{attributes:!0,attributeFilter:["href","data-route"]}),a(),t.removeAttribute("data-match")}};var q={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},_={select:"[data-bind],[name]",run:(t,r)=>{let n=t.getAttribute("name")||t.dataset.bind,e=p(r,n);if(e){let a=o=>{t.type=="checkbox"?t.checked=o:t.value=o};a(d(e)),m(e)&&(e.subscribe({next:a}),t.addEventListener("input",()=>e(q[t.type]?.(t)??t.value)),t.addEventListener("change",()=>e(q[t.type]?.(t)??t.value)))}}};var P=new WeakMap,H=new IntersectionObserver(t=>{for(let r of t)if(r.isIntersecting&&P.has(r.target)){for(let n of P.get(r.target))n();P.delete(r.target),H.unobserve(r.target)}},{rootMargin:"256px"});function x(t){return new Promise(r=>{let n=P.get(t)??[];n.push(r),P.set(t,n),H.observe(t)})}var C=new WeakSet,U={select:"[data-include]",run:(t,r)=>{if(C.has(t)||t.children.length)return;C.add(t);let n=t.hasAttribute("data-lazy")&&t.closest("[hidden]"),e=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0}));let a=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(a.ok){let o=await a.text();t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),t.innerHTML=o;for(let s of t.childNodes)b(s,r);t.removeAttribute("data-include"),t.removeAttribute("data-lazy")}};t.hasAttribute("data-lazy")?x(t).then(e):e()}};var $=new WeakSet,F={select:"[data-for]",run:(t,r,n)=>{if($.has(t))return;let e=t.dataset.for.replace("let","").split("of"),a=e[0].split(","),o=e.at(-1).trim(),s=a[0].trim()==o?"__e":a[0].trim(),c=a[1]?.trim()??"__i",i=p(r,o),l=document.createComment(t.dataset.for);t.replaceWith(l),C.add(t);let u=()=>{let f=l;for(;(f=f.nextSibling)&&(f instanceof HTMLElement&&f.dataset.for==t.dataset.for);)f=f.previousSibling,f.nextSibling.remove()},w=f=>{if(u(),!f||!f[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:o,value:f});for(let y=0,O=l;y<f.length;y++){let W=t.cloneNode(!0),nt=Object.assign({},r,{[s]:f[y],[c]:y});$.add(W),O.after(b(W,nt)),O=O.nextSibling}};w(d(i)),m(i)&&i.subscribe({next:w}),n()}};var V={select:"[data-if]",run:(t,r)=>{let n=p(r,t.dataset.if),e=document.createComment("if: "+t.dataset.if);t.replaceWith(e);let a=o=>{!t.parentNode&&o?(t.hidden=!1,e.after(t)):t.localName!="link"&&t.remove()};a(d(n)),m(n)&&n.subscribe({next:a})}};var J=new WeakSet,D={select:"[data-lazy]",run:(t,r,n)=>{if(J.has(t)||!t.childNodes.length)return;J.add(t);let e=t.dataset.lazy,a=()=>{t.removeAttribute("data-lazy"),z(t,r);for(let o of t.childNodes)b(o,r)};e&&(t.addEventListener("::load",()=>t.classList.add(e),{once:!0}),t.addEventListener("::loaded",()=>t.classList.remove(e),{once:!0})),x(t).then(a),n()}};var K={select:"[data-on]",run:(t,r)=>{let n=e=>{let a=e.split(":"),o=a[0].trim(),s=a.at(-1).trim(),c=p(r,s);c&&t.addEventListener(o,c)};for(let e of t.dataset.on.split(","))n(e)}};var G=t=>{let r=document.createElement("link");Object.assign(r,t),r.rel="preload",document.head.append(r)};var Q=new WeakSet,X={select:"[data-preload]",run:t=>{if(Q.has(t)||t.hidden)return;Q.add(t);let r=()=>{let n=t.dataset.preload.split(",");for(let e of n){let a=e.split(":");G({href:a[0],as:a[1]??"fetch"})}};t.hasAttribute("data-lazy")?x(t).then(r):r()}};var ft=t=>{let r=t.dataset.route;for(;t=t.parentElement;)t.dataset.route&&(r=t.dataset.route+r);return r.replaceAll(/\/+/g,"/")},Y={select:"[data-route]",run:async t=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let r=ft(t),n=new URLPattern({pathname:r}),e=document.createComment("route: "+r);t.replaceWith(e);let a=()=>{let o=location.href.replace(/index\.*[a-z0-9]*$/gm,"");if(!t.parentNode&&n.test(o)){t.hidden=!1,e.after(t);let s=document.querySelector('head meta[name="route"]');s&&(s.content=n.pathname)}else t.localName!="link"&&t.remove()};L.subscribe({next:a}),a()}};var Z=[F,V,Y,X,U,K,_,R,D];var tt={};function me(t,r={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let e=document.querySelector('head meta[name="template-path"]');return tt[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(e?.content?.replaceAll("[name]",t.toString())??t).then(c=>c.text());let o=n.content.querySelectorAll('link[rel="stylesheet"][href]'),s=[];for(let c of o)s.push(fetch(c.href).then(i=>i.text()).then(i=>{let l=document.createElement("style");l.innerHTML=i,c.replaceWith(l)}));await Promise.all(s),document.body.append(n),a(n)}),tt[t].then(a=>b(a.content.cloneNode(!0),r))}return b(n.content.cloneNode(!0),r)}function de(t,r={}){let n=document.createElement("template");return n.dataset.name="anonymous",n.innerHTML=t,b(n.content.cloneNode(!0),r)}function b(t,r={}){let n=(e,a=new WeakSet)=>{let o=!1;if(!(j(e)||a.has(e))){if(e.nodeName=="#document-fragment"&&A(e,r),e instanceof HTMLElement){A(e,r);for(let s of Z)e.matches(s.select)&&s.run(e,r,()=>o=!0);if(o)return;z(e,r)}else if(e instanceof Text&&e.textContent.includes("{{")){let s=e.textContent.split(/{{|}}/g);for(let c=0,i=e,l;c<s.length;c++)l=document.createTextNode(s[c]),c%2!=0&&et(`{{${s[c]}}}`,r,u=>l.data=u.replaceAll("<null>","")),a.add(l),i.after(l),i=l;e.remove()}a.add(e);for(let s of e.childNodes)n(s,a)}};return n(t,new WeakSet),t}var z=(t,r)=>{let n=t.getAttributeNames();for(let e of n){let a=t.getAttribute(e);a?.includes("{{")?et(a,r,o=>{o=o.trim().replace(/ +/," "),o==="<null>"?t.removeAttribute(e):t.setAttribute(e,o)}):t.localName.includes("-")&&B(r,a)&&t.setAttribute(e,`@parent.${a}`)}},et=(t,r,n)=>{let e=t.match(/{{[^}]+}}/g).map(T),a=t,o=()=>{t=a;for(let s of e){let c=d(s.value);t=t.replace(s.text,c??"<null>")}return t};for(let s of e){let c=p(r,s.prop);if(c==null&&console.warn(`{{ ${s.prop} }}: No value for this key`,{key:s.prop,value:c}),m(c)){let i=c;for(let l in s.meta)if(v[l]){let u=v[l];i=i.map(w=>u({value:w,key:s.prop,param:s.meta[l],options:s.meta}))}s.value=i,i.subscribe({next:()=>n(o())})}else{let i=c;for(let l in s.meta)if(v[l]){let u=v[l];i=u({value:d(c),key:s.prop,param:s.meta[l],options:s.meta})}s.value=()=>i}}n(o())};function ye(t,r,n){customElements.define(t,class extends HTMLElement{static observedAttributes=Object.keys(r).map(e=>e.toLowerCase());#e=Object.fromEntries(Object.entries(r).map(e=>[e[0],h(e[1])]));#t={};#r=!1;#n=null;on(e,a,o=null){this.addEventListener(e,a,o)}querySelector(e){return this.shadowRoot.querySelector(e)}querySelectorAll(e){return this.shadowRoot.querySelectorAll(e)}async connectedCallback(){if(this.#n??=this.hasAttribute("data-lazy"),this.#n&&(await x(this),this.removeAttribute("data-lazy")),this.dispatchEvent(new CustomEvent("::load",{bubbles:!0})),this.#r){this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),this.dispatchEvent(new CustomEvent("::mount"));return}let e=this.shadowRoot??this.attachShadow({mode:"open"}),a=n(this.#e,this);(s=>{A(this,E(s)),this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),e.append(s),this.#r=!0,this.#t["::attributes"]=new AbortController;for(let c in r)this.hasAttribute(c)||this.setAttribute(c,r[c].toString()),this.#e[c].subscribe({next:i=>this.setAttribute(c,i.toString())},{signal:this.#t["::attributes"].signal});this.dispatchEvent(new CustomEvent("::mount"))})(a instanceof Promise?await a:a)}disconnectedCallback(){this.dispatchEvent(new CustomEvent("::unmount"))}#a(e=""){e=e.toLowerCase();for(let a in this.#e)if(a.toLowerCase()==e)return[r[a],this.#e[a]];return[null,null]}attributeChangedCallback(e,a,o){let[s,c]=this.#a(e);if(o.startsWith("@parent.")){let i=this.parentNode.host||this.parentNode,l=o.slice(8),u=p(E(i),l)??p(E(this),l);m(u)?(this.#t[s]?.abort(),this.#t[s]=new AbortController,c(d(u)),u.subscribe({next:c},{signal:this.#t[s].signal})):c(u)}else c(typeof s=="number"?parseFloat(o):o)}})}var rt=new WeakMap;function Se(t,r=null){document.dispatchEvent(new CustomEvent(t,{detail:r}))}function Ee(t,r){let n=e=>r(e.detail);rt.set(r,n),document.addEventListener(t,n)}function Ae(t){return new Promise(r=>{let n=e=>r(e.detail);document.addEventListener(t,n,{once:!0})})}function ke(t,r){document.removeEventListener(t,rt.get(r))}export{ye as component,ht as deletePropsOf,st as effect,Se as emit,z as executeNodeAttributesTemplate,T as expression,d as f,B as hasProp,j as hasProps,m as isSignal,xt as memo,ke as off,Ee as on,Ae as once,v as pipes,Z as plugins,p as prop,E as propsOf,ot as resource,yt as resourceBy,A as setPropsOf,h as signal,me as templateByName,b as templateByNode,de as templateByString};
