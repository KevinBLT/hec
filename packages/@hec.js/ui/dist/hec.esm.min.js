function j(t){let r=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let e of r)if(e[1].includes("=")){let a=e[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=e[1];return n}var v={};var S=new WeakMap,A=t=>S.get(t),wt=t=>S.delete(t),B=t=>S.has(t),N=(t,r)=>{let n=A(t);n&&typeof n=="object"?S.set(t,Object.assign(n,r)):S.set(t,r)},p=t=>typeof t=="function"?p(t()):t;function d(t,r){let n=r.split(".");if(!r)return t;for(let e of n){if(["state"].includes(e)&&t?.state)return t[e];if(m(t)){let a=t()?.[e];if(m(a)){let i=new AbortController,s=h(a());a.subscribe({next:s},{signal:i.signal});let o=l=>{i.abort(),m(l[e])?(i=new AbortController,l[e].subscribe({next:s},{signal:i.signal}),s(l[e]())):s(l[e])};t.subscribe({next:o}),t=s}else t=t.map(i=>i&&i[e])}else if(typeof t=="function")t=p(t);else if(typeof t[e]<"u")typeof t[e]=="function"&&!m(t[e])?t=t[e].bind(t):t=t[e];else return}return t}function I(t,r){let n=r.split(".");if(!r)return!1;for(let e of n){if(["loading","error"].includes(e)&&t?.loading&&t?.error)return t[e];if(typeof t=="function")t=p(t);else if(typeof t[e]<"u")t=t[e];else return!1}return!0}var _={items:new Map,setItem(t,r){this.items.set(t,r?.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},k=new Map;function lt(t){try{let r=window[t+"Storage"];return typeof r.length=="number"?r:_}catch{return _}}window.addEventListener("storage",t=>{if(!k.has(t.key))return;let r=k.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&r.update(JSON.parse(n))});function h(t=null,r={}){if(r.id&&k.has(r.id))return k.get(r.id);let n=[],e=r.storage&&lt(r.storage),a=l=>{t=l,e&&e.setItem(r.id,JSON.stringify(t));for(let c of n)c.next(t)};function i(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let s=(l,c=null)=>{n.push(l),c?.signal.addEventListener("abort",()=>{let u=n.indexOf(l);u>-1&&n.splice(u,1)},{once:!0})};if(e){let l=e.getItem(r.id);a(typeof l=="string"&&l!=="undefined"?JSON.parse(l):t)}let o=Object.assign(i,{id:r.id,storage:r.storage,toString:()=>t?.toString(),set:l=>t=l,update:a,subscribe:s,map:l=>{let c=h(l(t)),u=new AbortController,b=c.subscribe;return s({next:f=>c(l(f))},{signal:u.signal}),Object.assign(c,{set:()=>null,subscribe:(f,y)=>{b(f,y),y?.signal.addEventListener("abort",()=>u.abort())}})},filter:l=>{let c=h(l(t)?t:null);return s({next:u=>l(u)?c(u):null}),Object.assign(c,{set:()=>null})}});return r.id&&k.set(r.id,o),o}function ct(t,r=[],n=null){for(let e of r)e.subscribe({next:()=>n=t(n)});return t(n)}function At(t,r=[],n=null){let e=h(null);return e(ct(a=>e(t(a)),r,n)),e}function ut(t,r=null){let n=h(r),e=h("loaded"),a=async()=>{if(e()!="pending"){try{e("pending"),n(await t()),e("loaded"),delete n.error}catch(i){e("error"),n.error=i}return n()}};return a(),Object.assign(n,{state:e,refetch:a})}function Nt(t,r,n=null){let e=ut(()=>r(p(t)),n);return m(t)&&t.subscribe({next:()=>e.refetch()}),e}function m(t){return t&&t.subscribe}function kt(t,r=[]){function n(){let e=h(null),a=null,i=s=>{a=s,e(t(s))};for(let s of r)s.subscribe({next:()=>e(t(a))});return Object.assign({provide:i},e)}return n}var ft=h({}),C=h(location.pathname),mt=window.history.pushState,pt=window.history.replaceState,M=[],q=new WeakMap;function dt(t,r){let n=Array.from(t.path.matchAll(/\:/g)).length*25,e=Array.from(r.path.matchAll(/\:/g)).length*25;return n+=Array.from(t.path.matchAll(/\*/g)).length*150,e+=Array.from(r.path.matchAll(/\*/g)).length*150,n-e}function H(t){let r=t.node,n=t.path,e=r.parentElement?.closest("[data-route]"),a=q.get(e),i=a?.pattern?.pathname,s=a?.group??M;t.group=[],q.set(r,t),i&&(n=n=="/"?"":n,n=i.replaceAll(/[^\/a-zA-Z0-9]+$/gm,"")+n.replaceAll(/^[^\/a-zA-Z0-9]+/gm,"")),n=n.replaceAll(/\/+/g,"/").replace(/\/$/m,""),t.pattern=new URLPattern({pathname:n||"/"}),s.push(t),s.sort(dt)}var P=document.querySelector('head meta[name="route"]')||document.createElement("meta");P.name="route";P.content=location.pathname;document.head.append(P);var w=()=>{let t=location.href.replace(/index\.*[a-z0-9]*$/gm,"");C(t),ft(Object.fromEntries(new URLSearchParams(location.search)));let r=n=>{let e=!1;for(let a of n){let i=a.pattern.test(t);a.update(!e&&i),i&&(e=!0,P.content=a.pattern.pathname,r(a.group))}};r(M)},ht=t=>{let r=t.target.closest("a")?.href,n=new URL(r,location.href);r&&n.hostname==location.hostname&&M.some(e=>e.pattern.test(r))&&(history.pushState(null,null,r),t.preventDefault())};window.addEventListener("popstate",w);window.addEventListener("hashchange",w);window.addEventListener("click",ht);window.history.pushState=function(r,n,e){mt.call(window.history,r,n,e),w()};window.history.replaceState=function(r,n,e){pt.call(window.history,r,n,e),w()};var z=new WeakMap,gt=new MutationObserver(t=>{for(let r of t)z.has(r.target)&&z.get(r.target)()}),$={select:"[data-match]",run:t=>{let r=t.dataset.match,n=i=>i.replace(/index\.*[a-z0-9]*$/gm,"");function e(){return n(new URL(t.dataset.route||t.getAttribute("href"),location.href).pathname)}let a=()=>{e()==n(location.pathname)?t.classList.add(r):t.classList.remove(r)};C.subscribe({next:a}),z.set(t,a),gt.observe(t,{attributes:!0,attributeFilter:["href","data-route"]}),a(),t.removeAttribute("data-match")}};var U={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},V={select:"[data-bind],[name]",run:(t,r)=>{let n=t.dataset.bind||t.getAttribute("name"),e=d(r,n);if(e){let a=i=>{t.type=="checkbox"?t.checked=i:t.value=i};a(p(e)),m(e)&&(e.subscribe({next:a}),t.addEventListener("input",()=>e(U[t.type]?.(t)??t.value)),t.addEventListener("change",()=>e(U[t.type]?.(t)??t.value)))}}};var L=new WeakMap,F=new IntersectionObserver(t=>{for(let r of t)if(r.isIntersecting&&L.has(r.target)){for(let n of L.get(r.target))n();L.delete(r.target),F.unobserve(r.target)}},{rootMargin:"256px"});function x(t){return new Promise(r=>{let n=L.get(t)??[];n.push(r),L.set(t,n),F.observe(t)})}var E=new WeakSet,G={select:"[data-include]",run:(t,r)=>{if(E.has(t)||t.children.length)return;E.add(t);let n=t.hasAttribute("data-lazy")&&t.closest("[hidden]"),e=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0}));let a=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(a.ok){let i=await a.text();t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),t.innerHTML=i;for(let s of t.childNodes)g(s,r);t.removeAttribute("data-include"),t.removeAttribute("data-lazy")}};t.hasAttribute("data-lazy")?x(t).then(e):e()}};var J=new WeakSet,D={select:"[data-for]",run:(t,r,n)=>{if(J.has(t))return;let e=t.dataset.for.replace("let","").split("of"),a=e[0].split(","),i=e.at(-1).trim(),s=a[0].trim()==i?"__e":a[0].trim(),o=a[1]?.trim()??"__i",l=d(r,i),c=document.createComment(t.dataset.for);t.replaceWith(c),E.add(t);let u=()=>{let f=c;for(;(f=f.nextSibling)&&((f instanceof HTMLElement||f instanceof SVGElement)&&f.dataset.for==t.dataset.for);)f=f.previousSibling,f.nextSibling.remove()},b=f=>{if(u(),!f||!f[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:i,value:f});for(let y=0,O=c;y<f.length;y++){let T=t.cloneNode(!0),ot=Object.assign({},r,{[s]:f[y],[o]:y});J.add(T),O.after(g(T,ot)),O=O.nextSibling}};b(p(l)),m(l)&&l.subscribe({next:b}),n()}};var K={select:"[data-if], [data-if-not]",run:(t,r)=>{let n=d(r,t.dataset.if||t.dataset.ifNot),e=document.createComment("if: "+(t.dataset.if||t.dataset.ifNot)),a=!!t.dataset.ifNot;t.replaceWith(e);let i=s=>{s=a?!s:s,!t.parentNode&&s?(t.hidden=!1,e.after(t)):t.localName!="link"&&t.remove()};i(p(n)),m(n)&&n.subscribe({next:i})}};var Z=new WeakSet,Q={select:"[data-lazy]",run:(t,r,n)=>{if(Z.has(t)||!t.childNodes.length)return;Z.add(t);let e=t.dataset.lazy,a=()=>{t.removeAttribute("data-lazy"),W(t,r);for(let i of t.childNodes)g(i,r)};e&&(t.addEventListener("::load",()=>t.classList.add(e),{once:!0}),t.addEventListener("::loaded",()=>t.classList.remove(e),{once:!0})),x(t).then(a),n()}};var X={select:"[data-on]",run:(t,r)=>{let n=e=>{let a=e.split(":"),i=a[0].trim(),s=a.at(-1).trim(),o=d(r,s);o&&t.addEventListener(i,o)};for(let e of t.dataset.on.split(","))n(e)}};var Y=t=>{let r=document.createElement("link");Object.assign(r,t),r.rel="preload",document.head.append(r)};var tt=new WeakSet,et={select:"[data-preload]",run:t=>{if(tt.has(t)||t.hidden)return;tt.add(t);let r=()=>{let n=t.dataset.preload.split(",");for(let e of n){let a=e.split(":");Y({href:a[0],as:a[1]??"fetch"})}};t.hasAttribute("data-lazy")?x(t).then(r):r()}};var rt={select:"[data-route], [data-route-not]",run:async t=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let r=t.dataset.route,n=document.createComment("route: "+r);H({path:r,update:a=>{if(a){if(t.hidden=!1,t.parentNode)return;n.after(t)}else t.localName!="link"&&t.remove()},node:t}),t.replaceWith(n)}};var nt=[D,K,rt,et,G,X,V,$,Q];var at={},R={};function ye(t,r={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let e=document.querySelector('head meta[name="template-path"]');return at[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(e?.content?.replaceAll("[name]",t.toString())??t).then(o=>o.text());let i=n.content.querySelectorAll('link[rel="stylesheet"][href]'),s=[];for(let o of i)R[o.href]??=fetch(o.href,{headers:{accept:"text/css"}}).then(l=>l.text()),R[o.href].then(l=>{let c=document.createElement("style");c.innerHTML=l,o.replaceWith(c)}),s.push(R[o.href]);await Promise.all(s),document.body.append(n),a(n)}),at[t].then(a=>g(a.content.cloneNode(!0),r))}return g(n.content.cloneNode(!0),r)}function we(t,r={}){let n=document.createElement("template");return n.dataset.name="anonymous",n.innerHTML=t,g(n.content.cloneNode(!0),r)}function g(t,r={}){let n=(e,a=new WeakSet)=>{let i=!1;if(!(B(e)||a.has(e))){if(e.nodeName=="#document-fragment"&&N(e,r),e instanceof HTMLElement||e instanceof SVGElement){N(e,r);for(let s of nt)e.matches(s.select)&&s.run(e,r,()=>i=!0);if(i)return;W(e,r)}else if(e instanceof Text&&e.textContent.includes("{{")){let s=e.textContent.split(/{{|}}/g);for(let o=0,l=e,c;o<s.length;o++)c=document.createTextNode(s[o]),o%2!=0&&st(`{{${s[o]}}}`,r,u=>c.data=u),a.add(c),l.after(c),l=c;e.remove()}a.add(e);for(let s of e.childNodes)n(s,a)}};return n(t,new WeakSet),queueMicrotask(w),t}var W=(t,r)=>{let n=t.getAttributeNames();for(let e of n){let a=t.getAttribute(e);a?.includes("{{")?st(a,r,i=>{i=i.trim().replace(/ +/," "),i==="undefined"||i==="null"?t.removeAttribute(e):t.setAttribute(e,i)}):t.localName.includes("-")&&I(r,a)&&t.setAttribute(e,`@parent.${a}`)}},st=(t,r,n)=>{let e=t.match(/{{[^}]+}}/g).map(j),a=t,i=()=>{t=a;for(let s of e)t=t.replace(s.text,p(s.value));return t};for(let s of e){let o=null;if(s.prop[s.prop.length-1]===")"){let l=s.prop.split("("),c=d(r,l[1].substring(0,l[1].length-1).trim()),u=l[0].trim();o=d(r,u),o=o(),o.provide(p(c)),m(c)&&c.subscribe({next:b=>o.resolve(p(b))})}else o=d(r,s.prop);if(o==null&&console.warn(`{{ ${s.prop} }}: No value for this key`,{key:s.prop,value:o}),m(o)){let l=o;for(let c in s.meta)if(v[c]){let u=v[c];l=l.map(b=>u({value:b,key:s.prop,param:s.meta[c],options:s.meta}))}s.value=l,l.subscribe({next:()=>n(i())})}else{let l=o;for(let c in s.meta)if(v[c]){let u=v[c];l=u({value:p(o),key:s.prop,param:s.meta[c],options:s.meta})}s.value=()=>l}}n(i())};function Pe(t,r,n){customElements.define(t,class extends HTMLElement{static observedAttributes=Object.keys(r).map(e=>e.toLowerCase());#t=Object.fromEntries(Object.entries(r).map(e=>[e[0],h(e[1])]));#e={};#r=!1;#n=null;on(e,a,i=null){this.addEventListener(e,a,i)}emit(e,a=null,i=!1){this.dispatchEvent(new CustomEvent(e,{detail:a,bubbles:i}))}async connectedCallback(){if(this.#n??=this.hasAttribute("data-lazy"),this.#n&&!this.#r)this.#r=!0,this.emit("::load",null,!0),this.removeAttribute("data-lazy"),await x(this);else{if(this.#r)return this.emit("::mount");await Promise.resolve(),this.emit("::load",null,!0),this.#r=!0}let e=this.shadowRoot??this.attachShadow({mode:"open"}),a=n(this.#t,this);(s=>{if(N(this,A(s)),"querySelector"in s){let o=s.querySelector("slot");if(o)for(;o.firstChild;)this.append(o.firstChild)}e.append(s),this.emit("::loaded",null,!0);for(let o in r){let l=this.getAttribute(o)??"";this.hasAttribute(o)||this.setAttribute(o,r[o]?.toString()),l.startsWith("@parent.")||(this.#e[o]??=new AbortController,this.#t[o].subscribe({next:c=>c==null?this.removeAttribute(o):this.setAttribute(o,c.toString())},{signal:this.#e[o].signal}))}this.dispatchEvent(new CustomEvent("::mount"))})(a instanceof Promise?await a:a)}disconnectedCallback(){this.dispatchEvent(new CustomEvent("::unmount"))}#a(e=""){e=e.toLowerCase();for(let a in this.#t)if(a.toLowerCase()==e)return[r[a],this.#t[a]];return[null,null]}attributeChangedCallback(e,a,i){let[s,o]=this.#a(e);if(i?.startsWith("@parent.")){let l=this.parentNode.host||this.parentNode,c=i.slice(8),u=d(A(l),c)??d(A(this),c);m(u)?(this.#e[e]?.abort(),this.#e[e]=new AbortController,this.#t[e]=u):o(u)}else o(typeof s=="number"?parseFloat(i):i)}})}var it=new WeakMap;function Ce(t,r=null){document.dispatchEvent(new CustomEvent(t,{detail:r}))}function Me(t,r){let n=e=>r(e.detail);it.set(r,n),document.addEventListener(t,n)}function ze(t){return new Promise(r=>{let n=e=>r(e.detail);document.addEventListener(t,n,{once:!0})})}function We(t,r){document.removeEventListener(t,it.get(r))}export{Pe as component,wt as deletePropsOf,ct as effect,Ce as emit,W as executeNodeAttributesTemplate,j as expression,p as f,I as hasProp,B as hasProps,m as isSignal,At as memo,We as off,Me as on,ze as once,v as pipes,nt as plugins,d as prop,A as propsOf,kt as provider,ut as resource,Nt as resourceBy,N as setPropsOf,h as signal,ye as templateByName,g as templateByNode,we as templateByString};
