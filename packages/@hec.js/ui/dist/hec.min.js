(()=>{var at=Object.create;var M=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var it=Object.getOwnPropertyNames;var lt=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var ut=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var ft=(t,e)=>{for(var r in e)M(t,r,{get:e[r],enumerable:!0})},mt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of it(e))!ct.call(t,o)&&o!==r&&M(t,o,{get:()=>e[o],enumerable:!(n=st(e,o))||n.enumerable});return t};var pt=(t,e,r)=>(r=t!=null?at(lt(t)):{},mt(e||!t||!t.__esModule?M(r,"default",{value:t,enumerable:!0}):r,t));var O={};ft(O,{component:()=>St,deletePropsOf:()=>z,effect:()=>H,emit:()=>Pt,expression:()=>j,f:()=>p,hasProp:()=>W,hasProps:()=>R,isSignal:()=>m,memo:()=>dt,off:()=>Nt,on:()=>Lt,once:()=>At,pipes:()=>v,plugins:()=>T,prop:()=>d,propsOf:()=>E,resource:()=>_,resourceBy:()=>ht,setPropsOf:()=>S,signal:()=>h,templateByName:()=>vt,templateByNode:()=>g,templateByString:()=>Et});function j(t){let e=t.matchAll(/([^ {}\s]+)/g),r={meta:{},text:t,prop:null};for(let n of e)if(n[1].includes("=")){let o=n[1].split("=");r.meta[o[0]]=o[1].replaceAll(/'|"/g,"")}else r.prop=n[1];return r}var v={};var L=new WeakMap,E=t=>L.get(t),z=t=>L.delete(t),R=t=>L.has(t),S=(t,e)=>{let r=E(t);r&&typeof r=="object"?L.set(t,Object.assign(r,e)):L.set(t,e)},p=t=>typeof t=="function"?p(t()):t;function d(t,e){let r=e.split(".");if(!e)return t;for(let n of r){if(["loading","error"].includes(n)&&t?.loading&&t?.error)return t[n];if(m(t)){let o=t()?.[n];if(m(o)){let s=new AbortController,a=h(o());o.subscribe({next:a},{signal:s.signal});let i=c=>{s.abort(),m(c[n])?(s=new AbortController,c[n].subscribe({next:a},{signal:s.signal}),a(c[n]())):a(c[n])};t.subscribe({next:i}),t=a}else t=t.map(s=>s&&s[n])}else if(typeof t=="function")t=p(t);else if(typeof t[n]<"u")typeof t[n]=="function"&&!m(t[n])?t=t[n].bind(t):t=t[n];else return null}return t}function W(t,e){let r=e.split(".");if(!e)return!1;for(let n of r){if(["loading","error"].includes(n)&&t?.loading&&t?.error)return t[n];if(typeof t=="function")t=p(t);else if(typeof t[n]<"u")t=t[n];else return!1}return!0}function h(t=null,e={}){let r=[],n=a=>{t=a;for(let i of r)i.next(t)};function o(){return arguments.length&&t!==arguments[0]&&n(arguments[0]),t}let s=(a,i=null)=>{r.push(a),i?.signal.addEventListener("abort",()=>{let c=r.indexOf(a);c>-1&&r.splice(c,1)},{once:!0})};return Object.assign(o,{signal:e.name??"",toString:()=>t.toString(),set:a=>t=a,update:n,subscribe:s,map:a=>{let i=h(a(t)),c=new AbortController,l=i.subscribe;return s({next:u=>i(a(u))},{signal:c.signal}),Object.assign(i,{set:()=>null,subscribe:(u,b)=>{l(u,b),b?.signal.addEventListener("abort",()=>c.abort())}})},filter:a=>{let i=h(a(t)?t:null);return s({next:c=>a(c)?i(c):null}),Object.assign(i,{set:()=>null})}})}function H(t,e=[],r=null){for(let n of e)n.subscribe({next:()=>r=t(r)});return t(r)}function dt(t,e=[],r=null){let n=h(null);return n(H(o=>n(t(o)),e,r)),n}function _(t,e=null){let r=h(e),n=h(!0),o=h(null),s=async()=>{try{r(await t()),n(!1)}catch(a){a(a)}return r()};return s(),Object.assign(r,{loading:n,error:o,refetch:s})}function ht(t,e,r=null){let n=_(()=>e(p(t)),r);return m(t)&&t.subscribe({next:()=>n.refetch()}),n}var m=t=>t&&t.subscribe;var bt=h({}),A=h(location.pathname);var w=document.querySelector('head meta[name="route"]');w||(w=document.createElement("meta"),w.name="route",w.content=location.pathname,document.head.append(w));var k=()=>{w.content="",A(location.pathname),bt(Object.fromEntries(new URLSearchParams(location.search))),w.content=w.content||location.pathname};window.addEventListener("popstate",k);window.addEventListener("hashchange",k);var gt=window.history.pushState,xt=window.history.replaceState;window.history.pushState=function(e,r,n){gt.call(window.history,e,r,n),k()};window.history.replaceState=function(e,r,n){xt.call(window.history,e,r,n),k()};var B=new WeakMap,wt=new MutationObserver(t=>{for(let e of t)B.has(e.target)&&B.get(e.target)()}),I={select:"[data-match]",run:t=>{let e=t.dataset.match,r=s=>s.replace(/index\.*[a-z0-9]*$/gm,"");function n(){return r(new URL(t.dataset.route||t.getAttribute("href"),location.href).pathname)}let o=()=>{n()==r(location.pathname)?t.classList.add(e):t.classList.remove(e)};A.subscribe({next:o}),B.set(t,o),wt.observe(t,{attributes:!0,attributeFilter:["href","data-route"]}),o(),t.removeAttribute("data-match")}};var U={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},F={select:"[data-bind],[name]",run:(t,e)=>{let r=t.getAttribute("name")||t.dataset.bind,n=d(e,r);if(n){let o=s=>{t.type=="checkbox"?t.checked=s:t.value=s};o(p(n)),m(n)&&(n.subscribe({next:o}),t.addEventListener("input",()=>n(U[t.type]?.(t)??t.value)),t.addEventListener("change",()=>n(U[t.type]?.(t)??t.value)))}}};var N=new WeakMap,V=new IntersectionObserver(t=>{for(let e of t)if(e.isIntersecting&&N.has(e.target)){for(let r of N.get(e.target))r();N.delete(e.target),V.unobserve(e.target)}},{rootMargin:"256px"});function y(t){return new Promise(e=>{let r=N.get(t)??[];r.push(e),N.set(t,r),V.observe(t)})}var C=new WeakSet,$={select:"[data-include]",run:(t,e)=>{if(C.has(t)||t.children.length)return;C.add(t);let r=t.hasAttribute("data-lazy")&&t.closest("[hidden]"),n=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0}));let o=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(o.ok){let s=await o.text();t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),t.innerHTML=s;for(let a of t.childNodes)g(a,e);t.removeAttribute("data-include"),t.removeAttribute("data-lazy")}};t.hasAttribute("data-lazy")?y(t).then(n):n()}};var D=new WeakSet,K={select:"[data-for]",run:(t,e,r)=>{if(D.has(t))return;let n=t.dataset.for.replace("let","").split("of"),o=n[0].split(","),s=n.at(-1).trim(),a=o[0].trim()==s?"__e":o[0].trim(),i=o[1]?.trim()??"__i",c=d(e,s),l=document.createComment(t.dataset.for);t.replaceWith(l),C.add(t);let u=()=>{let f=l;for(;(f=f.nextSibling)&&(f instanceof HTMLElement&&f.dataset.for==t.dataset.for);)f=f.previousSibling,f.nextSibling.remove()},b=f=>{u();for(let x=0,P=l;x<f.length;x++){let q=t.cloneNode(!0),ot=Object.assign({},e,{[a]:f[x],[i]:x});D.add(q),P.after(g(q,ot)),P=P.nextSibling}};b(p(c)),m(c)&&c.subscribe({next:b}),r()}};var G={select:"[data-if]",run:(t,e)=>{let r=d(e,t.dataset.if),n=document.createComment("if: "+t.dataset.if);t.replaceWith(n);let o=s=>{!t.parentNode&&s?(t.hidden=!1,n.after(t)):t.localName!="link"&&t.remove()};o(p(r)),m(r)&&r.subscribe({next:o})}};var J=new WeakSet,Q={select:"[data-lazy]",run:(t,e,r)=>{if(J.has(t)||!t.childNodes.length)return;J.add(t);let n=t.closest("[hidden]"),o=t.dataset.lazy,s=()=>{for(let a of t.childNodes)g(a,e);t.removeAttribute("data-lazy")};o&&(t.addEventListener("::load",()=>t.classList.add(o),{once:!0}),t.addEventListener("::loaded",()=>t.classList.remove(o),{once:!0})),y(t).then(s),r()}};var X={select:"[data-on]",run:(t,e)=>{let r=n=>{let o=n.split(":"),s=o[0].trim(),a=o.at(-1).trim(),i=d(e,a);i&&t.addEventListener(s,i)};for(let n of t.dataset.on.split(","))r(n)}};var Y=t=>{let e=document.createElement("link");Object.assign(e,t),e.rel="preload",document.head.append(e)};var Z=new WeakSet,tt={select:"[data-preload]",run:t=>{if(Z.has(t)||t.hidden)return;Z.add(t);let e=()=>{let r=t.dataset.preload.split(",");for(let n of r){let o=n.split(":");Y({href:o[0],as:o[1]??"fetch"})}};t.hasAttribute("data-lazy")?y(t).then(e):e()}};var yt=t=>{let e=t.dataset.route;for(;t=t.parentElement;)t.dataset.route&&(e=t.dataset.route+e);return e.replaceAll(/\/+/g,"/")},et={select:"[data-route]",run:async t=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/lib/src/plugins.js");let e=yt(t),r=new URLPattern({pathname:e}),n=document.createComment("route: "+e);t.replaceWith(n);let o=()=>{let s=location.href.replace(/index\.*[a-z0-9]*$/gm,"");if(!t.parentNode&&r.test(s)){t.hidden=!1,n.after(t);let a=document.querySelector('head meta[name="route"]');a&&(a.content=r.pathname)}else t.localName!="link"&&t.remove()};A.subscribe({next:o}),o()}};var T=[K,G,et,tt,$,X,F,I,Q];var nt={};function vt(t,e={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let r=document.querySelector(`template[name="${t}"]`);if(!r){let n=document.querySelector('head meta[name="template-path"]');return nt[t]??=new Promise(async o=>{r=document.createElement("template"),r.setAttribute("id",t.toString()),r.innerHTML=await fetch(n?.content?.replaceAll("[name]",t.toString())??t).then(s=>s.text()),document.body.append(r),o(r)}),nt[t].then(o=>g(o.content.cloneNode(!0),e))}return g(r.content.cloneNode(!0),e)}function Et(t,e={}){let r=document.createElement("template");return r.dataset.name="anonymous",r.innerHTML=t,g(r.content.cloneNode(!0),e)}function g(t,e={}){let r=(o,s)=>{let a=o.match(/{{[^}]+}}/g).map(j),i=o,c=()=>{o=i;for(let l of a){let u=p(l.value);o=o.replace(l.text,u??"<null>")}return o};for(let l of a){let u=d(e,l.prop);if(m(u)){let b=u;for(let f in l.meta)if(v[f]){let x=v[f];b=b.map(P=>x({value:P,key:l.prop,param:l.meta[f],options:l.meta}))}l.value=b,b.subscribe({next:()=>s(c())})}else{let b=u;for(let f in l.meta)if(v[f]){let x=v[f];b=x({value:p(u),key:l.prop,param:l.meta[f],options:l.meta})}l.value=()=>b}}s(c())},n=o=>{let s=!1;if(!R(o)){if(o.nodeName=="#document-fragment"&&S(o,e),o instanceof HTMLElement){let a=o.getAttributeNames();S(o,e);for(let i of T)o.matches(i.select)&&i.run(o,e,()=>s=!0);if(s)return;for(let i of a){let c=o.getAttribute(i);c?.includes("{{")?r(c,l=>{l=l.trim().replace(/ +/," "),l==="<null>"?o.removeAttribute(i):o.setAttribute(i,l)}):o.localName.includes("-")&&W(e,c)&&o.setAttribute(i,`@parent.${c}`)}}else if(o instanceof Text&&o.textContent.includes("{{")){let a=o.textContent.split(/{{|}}/g);for(let i=0,c=o,l;i<a.length;i++)l=document.createTextNode(a[i]),i%2!=0&&r(`{{${a[i]}}}`,u=>l.data=u.replaceAll("<null>","")),c.after(l),c=l;o.remove()}for(let a of o.childNodes)n(a)}};return n(t),t}function St(t,e,r){customElements.define(t,class extends HTMLElement{static observedAttributes=Object.keys(e).map(n=>n.toLowerCase());#e=Object.fromEntries(Object.entries(e).map(n=>[n[0],h(n[1])]));#t={};#n=!1;on(n,o,s=null){this.addEventListener(n,o,s)}querySelector(n){return this.shadowRoot.querySelector(n)}querySelectorAll(n){return this.shadowRoot.querySelectorAll(n)}async connectedCallback(){if(this.hasAttribute("data-lazy")&&await y(this),this.dispatchEvent(new CustomEvent("::load",{bubbles:!0})),this.#n){this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),this.dispatchEvent(new CustomEvent("::mount"));return}let n=this.shadowRoot??this.attachShadow({mode:"open"}),o=r(this.#e,this);(a=>{S(this,E(a)),this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),n.append(a),this.#n=!0,this.#t["::attributes"]=new AbortController;for(let i in e)this.hasAttribute(i)||this.setAttribute(i,e[i].toString()),this.#e[i].subscribe({next:c=>this.setAttribute(i,c.toString())},{signal:this.#t["::attributes"].signal});this.dispatchEvent(new CustomEvent("::mount"))})(o instanceof Promise?await o:o)}disconnectedCallback(){z(this);for(let n in this.#t)this.#t[n].abort(),delete this.#t[n];this.dispatchEvent(new CustomEvent("::unmount"))}#r(n=""){n=n.toLowerCase();for(let o in this.#e)if(o.toLowerCase()==n)return[e[o],this.#e[o]];return[null,null]}attributeChangedCallback(n,o,s){let[a,i]=this.#r(n);if(s.startsWith("@parent.")){let c=this.parentNode.host||this.parentNode,l=s.slice(8),u=d(E(c),l)??d(E(this),l);m(u)?(this.#t[a]?.abort(),this.#t[a]=new AbortController,i(p(u)),u.subscribe({next:i},{signal:this.#t[a].signal})):i(u)}else i(typeof a=="number"?parseFloat(s):s)}})}var rt=new WeakMap;function Pt(t,e=null){document.dispatchEvent(new CustomEvent(t,{detail:e}))}function Lt(t,e){let r=n=>e(n.detail);rt.set(e,r),document.addEventListener(t,r)}function At(t){return new Promise(e=>{let r=n=>e(n.detail);document.addEventListener(t,r,{once:!0})})}function Nt(t,e){document.removeEventListener(t,rt.get(e))}for(let t in O)globalThis[t]=O[t];})();
