(()=>{var yt=Object.create;var I=Object.defineProperty;var vt=Object.getOwnPropertyDescriptor;var wt=Object.getOwnPropertyNames;var At=Object.getPrototypeOf,Nt=Object.prototype.hasOwnProperty;var St=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(r,n)=>(typeof require<"u"?require:r)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var kt=(t,r)=>{for(var n in r)I(t,n,{get:r[n],enumerable:!0})},Et=(t,r,n,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of wt(r))!Nt.call(t,a)&&a!==n&&I(t,a,{get:()=>r[a],enumerable:!(e=vt(r,a))||e.enumerable});return t};var Lt=(t,r,n)=>(n=t!=null?yt(At(t)):{},Et(r||!t||!t.__esModule?I(n,"default",{value:t,enumerable:!0}):n,t));var B={};kt(B,{addRoute:()=>R,bindExpressions:()=>w,component:()=>$,componentSelector:()=>V,componentUpdate:()=>y,components:()=>L,effect:()=>D,emit:()=>_,executeNodeAttributesTemplate:()=>bt,expression:()=>U,f:()=>d,hasProp:()=>Rt,isSignal:()=>p,isValue:()=>K,memo:()=>Wt,navigate:()=>_t,nodeProps:()=>W,off:()=>Mt,on:()=>q,once:()=>Pt,page:()=>jt,pipes:()=>N,plugins:()=>Q,preload:()=>Ft,prop:()=>x,provider:()=>zt,query:()=>tt,resource:()=>Z,resourceBy:()=>Ct,route:()=>O,signal:()=>g,templateByName:()=>$t,templateByNode:()=>b,templateByString:()=>Ht,view:()=>Bt});function U(t){let r=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let e of r)if(e[1].includes("=")){let a=e[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=e[1];return n}var N={};var G=new WeakMap;function _(t,r=null){document.dispatchEvent(new CustomEvent(t,{detail:r}))}function q(t,r){let n=e=>r(e.detail);G.set(r,n),document.addEventListener(t,n)}function Pt(t){return new Promise(r=>{let n=e=>r(e.detail);document.addEventListener(t,n,{once:!0})})}function Mt(t,r){document.removeEventListener(t,G.get(r))}var J={items:new Map,setItem(t,r){this.items.set(t,r?.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},E=new Map;function Ot(t){try{let r=window[t+"Storage"];return typeof r.length=="number"?r:J}catch{return J}}window.addEventListener("storage",t=>{if(!E.has(t.key))return;let r=E.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&r.update(JSON.parse(n))});function g(t=null,r={}){if(r.id&&E.has(r.id))return E.get(r.id);let n=[],e=r.storage&&Ot(r.storage),a=s=>{t=s,e&&e.setItem(r.id,JSON.stringify(t));for(let u of n)u.next(t)};function o(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let i=(s,u=null)=>{n.push(s),u?.signal.addEventListener("abort",()=>{let l=n.indexOf(s);l>-1&&n.splice(l,1)},{once:!0})};if(e){let s=e.getItem(r.id);a(typeof s=="string"&&s!=="undefined"?JSON.parse(s):t)}let c=Object.assign(o,{id:r.id,storage:r.storage,toString:()=>t?.toString(),set:s=>t=s,update:a,subscribe:i,map:s=>{let u=g(s(t)),l=new AbortController,f=u.subscribe;return i({next:m=>u(s(m))},{signal:l.signal}),Object.assign(u,{set:()=>null,subscribe:(m,h)=>{f(m,h),h?.signal.addEventListener("abort",()=>l.abort())}})},filter:s=>{let u=g(s(t)?t:null);return i({next:l=>s(l)?u(l):null}),Object.assign(u,{set:()=>null})}});return r.id&&E.set(r.id,c),c}function D(t,r=[],n=null){for(let e of r)e.subscribe({next:()=>n=t(n)});return t(n)}function Wt(t,r=[],n=null){let e=g(null);return e(D(a=>e(t(a)),r,n)),e}function Z(t,r=null){let n=g(r),e=g("loaded"),a=async()=>{if(e()!="pending"){try{e("pending"),n(await t()),e("loaded"),delete n.error}catch(o){e("error"),n.error=o}return n()}};return a(),Object.assign(n,{state:e,refetch:a})}function Ct(t,r,n=null){let e=Z(()=>r(d(t)),n);return p(t)&&t.subscribe({next:()=>e.refetch()}),e}function p(t){return t&&t.subscribe}function zt(t,r=[]){function n(){let e=g(null),a=null,o=null,i=(c,s)=>{a=c,o=s,e(t(c,o))};for(let c of r)c.subscribe({next:()=>e(t(a,o))});return Object.assign(e,{provide:i})}return n}var d=t=>typeof t=="function"?d(t()):t;function x(t,r){let n=r?.split(".");if(!r)return t;if(!t)return null;for(let e of n){if(["state"].includes(e)&&t?.state)return t[e];if(p(t)){let a=t()?.[e];if(p(a)){let o=new AbortController,i=g(a());a.subscribe({next:i},{signal:o.signal});let c=s=>{o.abort(),p(s[e])?(o=new AbortController,s[e].subscribe({next:i},{signal:o.signal}),i(s[e]())):i(s[e])};t.subscribe({next:c}),t=i}else t=t.map(o=>o&&o[e])}else if(typeof t=="function")t=d(t);else if(typeof t[e]<"u")typeof t[e]=="function"&&!p(t[e])?t=t[e].bind(t):t=t[e];else return}return t}function Rt(t,r){let n=r.split(".");if(!r||!t)return!1;for(let e of n){if(["loading","error"].includes(e)&&t?.loading&&t?.error)return t[e];if(typeof t=="function")t=d(t);else if(typeof t[e]<"u")t=t[e];else return!1}return!0}var V="[data-component], [data-view], [data-page]",L=new Map,K=t=>t!=null,y=new WeakMap,Tt=new MutationObserver(t=>{for(let r of t)y.has(r.target)&&y.get(r.target)(r.attributeName)});function $(t,r,n){L.set(t,async(e,a)=>{let o={},i=Array.from(e.childNodes),c=(l,f)=>({number:parseFloat,boolean:h=>h===!0||h==="true"})[typeof r[l]]?.(f)??f,s=l=>{let f=e.getAttribute(l);for(let m in o)m.toLowerCase()==l&&o[m](c(m,f))};for(let l in r){let f=e.getAttribute(l)??r[l];if(typeof f=="string"&&f.startsWith("@")){let m=x(a,f.substring(1));o[l]=p(m)?m:g(m)}else o[l]=g(c(l,f)),o[l].subscribe({next:m=>K(m)?e.setAttribute(l,m):e.removeAttribute(l)})}Tt.observe(e,{attributeFilter:Object.keys(r).map(l=>l.toLowerCase())}),y.set(e,s);let u=n(o,e);if(u instanceof Promise&&(u=await u),e.append(u),i.length){let l=e.querySelector("slot"),f=document.createComment("children/"),m=document.createComment("/children");if(l){for(let h of i)h instanceof Element&&l.getAttributeNames().forEach(A=>h.setAttribute(A,l.getAttribute(A)));l.replaceWith(f,...i,m)}else e.append(f,...i);for(let h of i)b(h,Object.assign({},a,W.get(u)))}e.dispatchEvent(new CustomEvent("::mount"))}),_("::component/"+t)}var Bt=$,jt=$;var P=new WeakMap,M=new WeakMap,X=new IntersectionObserver(t=>{for(let r of t)if(r.isIntersecting&&P.has(r.target))for(let n of P.get(r.target))n(),P.delete(r.target),X.unobserve(r.target)},{rootMargin:"256px"});new MutationObserver(t=>{for(let r of t){let n=a=>{for(let o of a){if(y.has(o)&&o.dispatchEvent(new CustomEvent("::mount")),M.has(o)){let i=M.get(o);for(;i.length;)i.shift()();M.delete(o)}n(o.childNodes)}},e=a=>{for(let o of a)y.has(o)&&o.dispatchEvent(new CustomEvent("::unmount")),e(o.childNodes)};n(r.addedNodes),e(r.removedNodes)}}).observe(document,{childList:!0,subtree:!0});function S(t){return new Promise(r=>{let n=P.get(t)??[];n.push(r),P.set(t,n),X.observe(t)})}function C(t){return new Promise(r=>{let n=M.get(t)??[];t.getRootNode()==document&&queueMicrotask(()=>r()),n.push(r),M.set(t,n)})}var tt=g({}),O=g(location.pathname),et=window.history.pushState,It=window.history.replaceState,H={updateQueued:!1},z=document.querySelector('head meta[name="route"]')||document.createElement("meta");z.name="route";z.content=location.pathname;document.head.append(z);var rt=[],Y=new WeakMap;function Ut(t,r){let n=Array.from(t.path.matchAll(/\:/g)).length*25,e=Array.from(r.path.matchAll(/\:/g)).length*25;return n+=Array.from(t.path.matchAll(/\*/g)).length*150,e+=Array.from(r.path.matchAll(/\*/g)).length*150,n-e}function _t(t=""){window.history.pushState(null,null,t)}function R(t){let r=t.node,n=t.path,e=t.placeholder,a=r.parentElement??e?.parentElement,o=a?.closest("[data-route]"),i=Y.get(o),c=i?.pattern?.pathname,s=i?.group??rt;if(a?.getRootNode()!==document)return C(e).then(()=>R(t));t.group=[],Y.set(r,t),c&&(n=n=="/"?"":n,n=c.replaceAll(/[^\/a-zA-Z0-9]+$/gm,"")+n.replaceAll(/^[^\/a-zA-Z0-9]+/gm,"")),n=n.replaceAll(/\/+/g,"/").replace(/\/$/m,""),t.pattern=new URLPattern({pathname:n||"/"}),s.push(t),s.sort(Ut),H.updateQueued||(H.updateQueued=!0,queueMicrotask(v))}function v(t=location.href){t=new URL(t.replace(/index\.*[a-z0-9]*$/gm,""),location.href).toString();let r=!1,n=e=>{let a=!1;for(let o of e){let i=o.pattern.test(t);o.update(!a&&i),!a&&i?(a=!0,o.node.classList.add("--active"),o.group.length?n(o.group):(r=!0,z.content=o.pattern.pathname)):(o.node.classList.remove("--active"),o.node.className||o.node.removeAttribute("class"))}return r};return H.updateQueued=!1,n(rt)?(O(t),tt(Object.fromEntries(new URLSearchParams(location.search)))):v(O()),r}var qt=t=>{let r=t.target.closest("a"),n=r?.href,e=new URL(n,location.href);n&&!r.hasAttribute("download")&&e.hostname==location.hostname&&v(n)&&(et.call(window.history,null,null,n),t.preventDefault())};window.addEventListener("popstate",()=>v());window.addEventListener("hashchange",()=>v());window.addEventListener("click",qt);window.history.pushState=function(r,n,e){et.call(window.history,r,n,e),v(e.toString())};window.history.replaceState=function(r,n,e){It.call(window.history,r,n,e),v(e.toString())};var nt={select:t=>t.matches("[data-if], [data-if-not]"),run:(t,r)=>{let n=t.dataset.if||t.dataset.ifNot,e=!!t.dataset.ifNot,a=document.createComment((e?"if not:":"if: ")+n),o=F(t,a,r,e);t.replaceWith(a),t.removeAttribute("data-group"),w(n,r,o,!1)}};function Vt(t,r){if("group"in t.dataset&&t instanceof HTMLTemplateElement){let n=Array.from(t.content.childNodes);for(let e of n)b(e,r);return n}return[t]}function F(t,r,n,e=!1){let a=Vt(t,n),o=!!t.closest("head");return i=>{if(i=e?!i:i,!t.parentNode&&i)t.hidden=!1,r.replaceWith(...a);else if(!r.parentNode&&!i&&!o)for(let c of a)c.replaceWith(r)}}var at={select:t=>t.matches("[data-route]"),run:async(t,r)=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let n=t.dataset.route,e=document.createComment("route: "+n),a=F(t,e,r);R({path:n,update:a,node:t,placeholder:e}),t.removeAttribute("data-group"),t.replaceWith(e)}},ot={select:t=>t.matches("[data-match], [href]"),run:t=>{if(!t.parentNode||t.hasAttribute("download"))return;let r=t.dataset.match??"--active",n=o=>o.replace(/index\.*[a-z0-9]*$/gm,"");function e(o){return n(new URL(o,location.href).pathname)}let a=o=>{e(t.getAttribute("href"))==e(o)?t.classList.add(r):(t.classList.remove(r),t.className||t.removeAttribute("class"))};O.subscribe({next:a}),queueMicrotask(()=>a(location.pathname)),t.removeAttribute("data-match")}};var st={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},it={select:t=>t.matches("[data-bind]"),run:(t,r)=>{let n=t.dataset.bind||t.getAttribute("name"),e=x(r,n);if(e){let a=o=>{t.type=="checkbox"?t.checked=o:t.value=o};a(d(e)),p(e)&&(e.subscribe({next:a}),t.addEventListener("input",()=>e(st[t.type]?.(t)??t.value)),t.addEventListener("change",()=>e(st[t.type]?.(t)??t.value)))}}};var k=new WeakSet,ct={select:t=>t.matches("[data-lazy]"),run:(t,r,n)=>{if(k.has(t))return;k.add(t);let e=()=>{t.removeAttribute("data-lazy");for(let a of t.childNodes)b(a,r)};S(t).then(e),n()}};var T=new WeakSet,lt={select:t=>t.matches("[data-include]"),run:(t,r)=>{if(T.has(t)||t.children.length)return;T.add(t);let n=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0})),t.setAttribute("data-loading",t.dataset.include);let e=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(e.ok){let a=await e.text(),o=document.createElement("div");t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),o.innerHTML=a;for(let i of o.childNodes)b(i,r);"group"in t.dataset?t.replaceWith(...o.childNodes):t.append(...o.childNodes),t.removeAttribute("data-include"),t.removeAttribute("data-lazy"),t.removeAttribute("data-group"),t.removeAttribute("data-loading"),t.className||t.removeAttribute("class")}};t.hasAttribute("data-lazy")?(k.add(t),S(t).then(n)):n()}};var ut=new WeakSet,mt={select:t=>t.matches("[data-for]"),run:(t,r,n)=>{if(ut.has(t))return;let e=t.dataset.for.replace("let","").split("of"),a=e[0].split(","),o=e.at(-1).trim(),i=a[0].trim()==o?"__e":a[0].trim(),c=a[1]?.trim()??"__i",s=x(r,o),u=document.createComment(t.dataset.for);t.replaceWith(u),T.add(t);let l=()=>{let m=u;for(;(m=m.nextSibling)&&((m instanceof HTMLElement||m instanceof SVGElement)&&m.dataset.for==t.dataset.for);)m=m.previousSibling,m.nextSibling.remove()},f=m=>{if(l(),!m||!m[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:o,value:m});for(let h=0,A=u;h<m.length;h++){let j=t.cloneNode(!0),xt=Object.assign({},r,{[i]:m[h],[c]:h});ut.add(j),A.after(j),b(j,xt),A=A.nextSibling}};queueMicrotask(()=>f(d(s))),p(s)&&s.subscribe({next:f}),n()}};var ft={select:t=>Object.keys(t.dataset).some(r=>r.startsWith("on.")),run:(t,r)=>{for(let n in t.dataset)if(n.startsWith("on.")){let e=t.dataset[n];t.removeAttribute(n),t.addEventListener(n.split(".")[1],x(r,e))}}};var pt=new WeakSet,dt={select:t=>t.matches(V),run:(t,r,n)=>{let e=t.dataset.component??t.dataset.view??t.dataset.page;if(pt.has(t)||!t.parentNode)return;pt.add(t);let a=async()=>{if(!L.has(e))return q("::component/"+e,a);t.removeAttribute("data-lazy"),t.setAttribute("data-loading",e),await L.get(e)(t,r),t.removeAttribute("data-loading")};t.hasAttribute("data-lazy")?(k.add(t),S(t).then(a)):C(t).then(a),n()}};var ht={select:t=>Object.keys(t.dataset).some(r=>r.startsWith("class.")),run:(t,r)=>{if(!t.parentNode)return;let n=(e,a)=>{e?t.classList.add(a):(t.classList.remove(a),t.className||t.removeAttribute("class"))};for(let e of t.getAttributeNames())if(e.startsWith("data-class.")){let a=e.split(".")[1],o=t.getAttribute(e);t.removeAttribute(e),w(o,r,i=>n(i,a),!1)}}};var Q=[mt,dt,nt,at,lt,ft,ht,it,ot,ct];var gt={},W=new WeakMap;function $t(t,r={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let e=document.querySelector('head meta[name="template-path"]');return gt[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(e?.content?.replaceAll("[name]",t.toString())??t).then(o=>o.text()),document.body.append(n),a(n)}),gt[t].then(a=>b(a.content.cloneNode(!0),r))}return b(n.content.cloneNode(!0),r)}function Ht(t,r={}){let n=document.createElement("template");return n.innerHTML=t,b(n.content.cloneNode(!0),r)}function b(t,r={}){W.set(t,r);let n=(e,a=new WeakSet)=>{let o=!1;if(!a.has(e)){if(e instanceof HTMLElement||e instanceof SVGElement){for(let i of Q)i.select(e)&&i.run(e,r,()=>o=!0);if((e.parentNode||!e.dataset.for)&&bt(e,r),o)return}else if(e instanceof Text&&e.textContent.includes("{{")){let i=e.textContent.split(/{{|}}/g);for(let c=0,s=e,u;c<i.length;c++)u=document.createTextNode(i[c]),c%2!=0&&w(`{{${i[c]}}}`,r,l=>u.data=l),a.add(u),s.after(u),s=u;e.remove()}a.add(e);for(let i of e.childNodes)n(i,a)}};return n(t,new WeakSet),t}var bt=(t,r)=>{let n=t.getAttributeNames();for(let e of n){let a=t.getAttribute(e);a?.includes("{{")&&w(a,r,o=>{o=o.replace(/ +/," ").trim(),o==="undefined"||o==="null"?t.removeAttribute(e):t.setAttribute(e,o)})}},w=(t,r,n,e=!0)=>{let a=t.match(/{{[^}]+}}/g)?.map(U)??[],o=t;!e&&!a.length&&(a=[{prop:t,meta:{}}]);let i=()=>{t=o;for(let c of a)t=t.replace(c.text,d(c.value));return t};for(let c of a){let s=null;if(c.prop?.[c.prop.length-1]===")"){let u=c.prop.split("("),l=x(r,u[1].substring(0,u[1].length-1).trim()),f=u[0].trim();s=x(r,f),s=s(),s.provide(d(l),c.meta),p(l)&&l.subscribe({next:m=>s.provide(d(m),c.meta)})}else s=x(r,c.prop);if(s==null&&!Object.keys(c.meta).length&&console.warn(`{{ ${c.prop} }}: No value for this key`,{key:c.prop,value:s}),p(s)){let u=s;for(let l in c.meta)if(N[l]){let f=N[l];u=u.map(m=>f({value:m,key:c.prop,param:c.meta[l],options:c.meta}))}c.value=u,u.subscribe({next:l=>n(e?i():l)}),!e&&s.update(d(s))}else{let u=s;for(let l in c.meta)if(N[l]){let f=N[l];u=f({value:d(s),key:c.prop,param:c.meta[l],options:c.meta})}c.value=()=>u,!e&&n(u)}}e&&n(i())};var Ft=t=>{let r=document.head.querySelector(`link[rel="preload"][href="${t.href}"]`)??document.createElement("link");Object.assign(r,t),r.rel="preload",document.head.append(r)};for(let t in B)globalThis[t]=B[t];})();
