(()=>{var xt=Object.create;var I=Object.defineProperty;var yt=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames;var wt=Object.getPrototypeOf,At=Object.prototype.hasOwnProperty;var Nt=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var St=(t,e)=>{for(var n in e)I(t,n,{get:e[n],enumerable:!0})},kt=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of vt(e))!At.call(t,a)&&a!==n&&I(t,a,{get:()=>e[a],enumerable:!(r=yt(e,a))||r.enumerable});return t};var Lt=(t,e,n)=>(n=t!=null?xt(wt(t)):{},kt(e||!t||!t.__esModule?I(n,"default",{value:t,enumerable:!0}):n,t));var B={};St(B,{addRoute:()=>z,bindExpressions:()=>w,component:()=>F,componentSelector:()=>$,componentUpdate:()=>y,components:()=>L,effect:()=>D,emit:()=>_,executeNodeAttributesTemplate:()=>gt,expression:()=>U,f:()=>d,hasProp:()=>zt,isSignal:()=>p,memo:()=>Ot,navigate:()=>Ut,nodeProps:()=>M,off:()=>Pt,on:()=>q,once:()=>Et,page:()=>Tt,pipes:()=>A,plugins:()=>Q,preload:()=>Ht,prop:()=>b,provider:()=>Ct,query:()=>Y,resource:()=>Z,resourceBy:()=>Wt,route:()=>P,signal:()=>h,templateByName:()=>$t,templateByNode:()=>g,templateByString:()=>Ft,view:()=>Bt});function U(t){let e=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let r of e)if(r[1].includes("=")){let a=r[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=r[1];return n}var A={};var G=new WeakMap;function _(t,e=null){document.dispatchEvent(new CustomEvent(t,{detail:e}))}function q(t,e){let n=r=>e(r.detail);G.set(e,n),document.addEventListener(t,n)}function Et(t){return new Promise(e=>{let n=r=>e(r.detail);document.addEventListener(t,n,{once:!0})})}function Pt(t,e){document.removeEventListener(t,G.get(e))}var J={items:new Map,setItem(t,e){this.items.set(t,e?.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},k=new Map;function Mt(t){try{let e=window[t+"Storage"];return typeof e.length=="number"?e:J}catch{return J}}window.addEventListener("storage",t=>{if(!k.has(t.key))return;let e=k.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&e.update(JSON.parse(n))});function h(t=null,e={}){if(e.id&&k.has(e.id))return k.get(e.id);let n=[],r=e.storage&&Mt(e.storage),a=s=>{t=s,r&&r.setItem(e.id,JSON.stringify(t));for(let i of n)i.next(t)};function o(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let c=(s,i=null)=>{n.push(s),i?.signal.addEventListener("abort",()=>{let u=n.indexOf(s);u>-1&&n.splice(u,1)},{once:!0})};if(r){let s=r.getItem(e.id);a(typeof s=="string"&&s!=="undefined"?JSON.parse(s):t)}let l=Object.assign(o,{id:e.id,storage:e.storage,toString:()=>t?.toString(),set:s=>t=s,update:a,subscribe:c,map:s=>{let i=h(s(t)),u=new AbortController,f=i.subscribe;return c({next:m=>i(s(m))},{signal:u.signal}),Object.assign(i,{set:()=>null,subscribe:(m,x)=>{f(m,x),x?.signal.addEventListener("abort",()=>u.abort())}})},filter:s=>{let i=h(s(t)?t:null);return c({next:u=>s(u)?i(u):null}),Object.assign(i,{set:()=>null})}});return e.id&&k.set(e.id,l),l}function D(t,e=[],n=null){for(let r of e)r.subscribe({next:()=>n=t(n)});return t(n)}function Ot(t,e=[],n=null){let r=h(null);return r(D(a=>r(t(a)),e,n)),r}function Z(t,e=null){let n=h(e),r=h("loaded"),a=async()=>{if(r()!="pending"){try{r("pending"),n(await t()),r("loaded"),delete n.error}catch(o){r("error"),n.error=o}return n()}};return a(),Object.assign(n,{state:r,refetch:a})}function Wt(t,e,n=null){let r=Z(()=>e(d(t)),n);return p(t)&&t.subscribe({next:()=>r.refetch()}),r}function p(t){return t&&t.subscribe}function Ct(t,e=[]){function n(){let r=h(null),a=null,o=null,c=(l,s)=>{a=l,o=s,r(t(l,o))};for(let l of e)l.subscribe({next:()=>r(t(a,o))});return Object.assign(r,{provide:c})}return n}var d=t=>typeof t=="function"?d(t()):t;function b(t,e){let n=e?.split(".");if(!e)return t;if(!t)return null;for(let r of n){if(["state"].includes(r)&&t?.state)return t[r];if(p(t)){let a=t()?.[r];if(p(a)){let o=new AbortController,c=h(a());a.subscribe({next:c},{signal:o.signal});let l=s=>{o.abort(),p(s[r])?(o=new AbortController,s[r].subscribe({next:c},{signal:o.signal}),c(s[r]())):c(s[r])};t.subscribe({next:l}),t=c}else t=t.map(o=>o&&o[r])}else if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")typeof t[r]=="function"&&!p(t[r])?t=t[r].bind(t):t=t[r];else return}return t}function zt(t,e){let n=e.split(".");if(!e||!t)return!1;for(let r of n){if(["loading","error"].includes(r)&&t?.loading&&t?.error)return t[r];if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")t=t[r];else return!1}return!0}var $="[data-component], [data-view], [data-page]",L=new Map,y=new WeakMap,Rt=new MutationObserver(t=>{for(let e of t)y.has(e.target)&&y.get(e.target)(e.attributeName)});function F(t,e,n){L.set(t,async(r,a)=>{let o={},c=Array.from(r.childNodes),l=i=>{let u=r.getAttribute(i);for(let f in o)f.toLowerCase()==i&&o[f](typeof e[f]=="number"?parseFloat(u):u)};for(let i in e){let u=r.getAttribute(i)??e[i];if(typeof u=="string"&&u.startsWith("@")){let f=b(a,u.substring(1));o[i]=p(f)?f:h(f)}else o[i]=h(typeof e[i]=="number"?parseFloat(u):u),o[i].subscribe({next:f=>f?r.setAttribute(i,f):r.removeAttribute(i)})}Rt.observe(r,{attributeFilter:Object.keys(e).map(i=>i.toLowerCase())}),y.set(r,l);let s=n(o,r);if(s instanceof Promise&&(s=await s),r.append(s),c.length){let i=r.querySelector("slot"),u=document.createComment("children/"),f=document.createComment("/children");if(i){for(let m of c)m instanceof Element&&i.getAttributeNames().forEach(x=>m.setAttribute(x,i.getAttribute(x)));i.replaceWith(u,...c,f)}else r.append(u,...c);for(let m of c)g(m,Object.assign({},a,M.get(s)))}r.dispatchEvent(new CustomEvent("::mount"))}),_("::component/"+t)}var Bt=F,Tt=F;var E=new WeakMap,O=new WeakMap,K=new IntersectionObserver(t=>{for(let e of t)if(e.isIntersecting&&E.has(e.target))for(let n of E.get(e.target))n(),E.delete(e.target),K.unobserve(e.target)},{rootMargin:"256px"});new MutationObserver(t=>{for(let e of t){let n=a=>{for(let o of a){if(y.has(o)&&o.dispatchEvent(new CustomEvent("::mount")),O.has(o)){let c=O.get(o);for(;c.length;)c.shift()()}n(o.childNodes)}},r=a=>{for(let o of a)y.has(o)&&o.dispatchEvent(new CustomEvent("::unmount"))};n(e.addedNodes),r(e.removedNodes)}}).observe(document,{childList:!0,subtree:!0});function N(t){return new Promise(e=>{let n=E.get(t)??[];n.push(e),E.set(t,n),K.observe(t)})}function W(t){return new Promise(e=>{let n=O.get(t)??[];t.getRootNode()==document&&queueMicrotask(()=>e()),n.push(e),O.set(t,n)})}var Y=h({}),P=h(location.pathname),tt=window.history.pushState,jt=window.history.replaceState,H={updateQueued:!1},C=document.querySelector('head meta[name="route"]')||document.createElement("meta");C.name="route";C.content=location.pathname;document.head.append(C);var et=[],X=new WeakMap;function It(t,e){let n=Array.from(t.path.matchAll(/\:/g)).length*25,r=Array.from(e.path.matchAll(/\:/g)).length*25;return n+=Array.from(t.path.matchAll(/\*/g)).length*150,r+=Array.from(e.path.matchAll(/\*/g)).length*150,n-r}function Ut(t=""){window.history.pushState(null,null,t)}function z(t){let e=t.node,n=t.path,r=t.placeholder,a=e.parentElement??r?.parentElement,o=a?.closest("[data-route]"),c=X.get(o),l=c?.pattern?.pathname,s=c?.group??et;if(a?.getRootNode()!==document)return W(r).then(()=>z(t));t.group=[],X.set(e,t),l&&(n=n=="/"?"":n,n=l.replaceAll(/[^\/a-zA-Z0-9]+$/gm,"")+n.replaceAll(/^[^\/a-zA-Z0-9]+/gm,"")),n=n.replaceAll(/\/+/g,"/").replace(/\/$/m,""),t.pattern=new URLPattern({pathname:n||"/"}),s.push(t),s.sort(It),H.updateQueued||(H.updateQueued=!0,queueMicrotask(v))}function v(t=location.href){t=t.replace(/index\.*[a-z0-9]*$/gm,"");let e=!1,n=r=>{let a=!1;for(let o of r){let c=o.pattern.test(t);o.update(!a&&c),!a&&c?(a=!0,o.node.classList.add("--active"),o.group.length?n(o.group):(e=!0,C.content=o.pattern.pathname)):(o.node.classList.remove("--active"),o.node.className||o.node.removeAttribute("class"))}return e};return H.updateQueued=!1,n(et)?(P(t),Y(Object.fromEntries(new URLSearchParams(location.search)))):v(P()),e}var _t=t=>{let e=t.target.closest("a")?.href,n=new URL(e,location.href);e&&n.hostname==location.hostname&&v(e)&&(tt.call(window.history,null,null,e),t.preventDefault())};window.addEventListener("popstate",()=>v());window.addEventListener("hashchange",()=>v());window.addEventListener("click",_t);window.history.pushState=function(e,n,r){tt.call(window.history,e,n,r),v(r.toString())};window.history.replaceState=function(e,n,r){jt.call(window.history,e,n,r),v(r.toString())};var rt={select:t=>t.matches("[data-if], [data-if-not]"),run:(t,e)=>{let n=t.dataset.if||t.dataset.ifNot,r=!!t.dataset.ifNot,a=document.createComment((r?"if not:":"if: ")+n),o=V(t,a,e,r);t.replaceWith(a),t.removeAttribute("data-group"),w(n,e,o,!1)}};function qt(t,e){if("group"in t.dataset&&t instanceof HTMLTemplateElement){let n=Array.from(t.content.childNodes);for(let r of n)g(r,e);return n}return[t]}function V(t,e,n,r=!1){let a=qt(t,n),o=!!t.closest("head");return c=>{if(c=r?!c:c,!t.parentNode&&c)t.hidden=!1,e.replaceWith(...a);else if(!e.parentNode&&!c&&!o)for(let l of a)l.replaceWith(e)}}var nt={select:t=>t.matches("[data-route]"),run:async(t,e)=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let n=t.dataset.route,r=document.createComment("route: "+n),a=V(t,r,e);z({path:n,update:a,node:t,placeholder:r}),t.removeAttribute("data-group"),t.replaceWith(r)}},at={select:t=>t.matches("[data-match], [href]"),run:t=>{if(!t.parentNode)return;let e=t.dataset.match??"--active",n=o=>o.replace(/index\.*[a-z0-9]*$/gm,"");function r(o){return n(new URL(o,location.href).pathname)}let a=o=>{r(t.getAttribute("href"))==r(o)?t.classList.add(e):(t.classList.remove(e),t.className||t.removeAttribute("class"))};P.subscribe({next:a}),queueMicrotask(()=>a(location.pathname)),t.removeAttribute("data-match")}};var ot={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},st={select:t=>t.matches("[data-bind]"),run:(t,e)=>{let n=t.dataset.bind||t.getAttribute("name"),r=b(e,n);if(r){let a=o=>{t.type=="checkbox"?t.checked=o:t.value=o};a(d(r)),p(r)&&(r.subscribe({next:a}),t.addEventListener("input",()=>r(ot[t.type]?.(t)??t.value)),t.addEventListener("change",()=>r(ot[t.type]?.(t)??t.value)))}}};var S=new WeakSet,it={select:t=>t.matches("[data-lazy]"),run:(t,e,n)=>{if(S.has(t))return;S.add(t);let r=()=>{t.removeAttribute("data-lazy");for(let a of t.childNodes)g(a,e)};N(t).then(r),n()}};var R=new WeakSet,ct={select:t=>t.matches("[data-include]"),run:(t,e)=>{if(R.has(t)||t.children.length)return;R.add(t);let n=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0})),t.classList.add("--loading");let r=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(r.ok){let a=await r.text(),o=document.createElement("div");t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),o.innerHTML=a;for(let c of o.childNodes)g(c,e);"group"in t.dataset?t.replaceWith(...o.childNodes):t.append(...o.childNodes),t.removeAttribute("data-include"),t.removeAttribute("data-lazy"),t.removeAttribute("data-group"),t.classList.remove("--loading"),t.className||t.removeAttribute("class")}};t.hasAttribute("data-lazy")?(S.add(t),N(t).then(n)):n()}};var lt=new WeakSet,ut={select:t=>t.matches("[data-for]"),run:(t,e,n)=>{if(lt.has(t))return;let r=t.dataset.for.replace("let","").split("of"),a=r[0].split(","),o=r.at(-1).trim(),c=a[0].trim()==o?"__e":a[0].trim(),l=a[1]?.trim()??"__i",s=b(e,o),i=document.createComment(t.dataset.for);t.replaceWith(i),R.add(t);let u=()=>{let m=i;for(;(m=m.nextSibling)&&((m instanceof HTMLElement||m instanceof SVGElement)&&m.dataset.for==t.dataset.for);)m=m.previousSibling,m.nextSibling.remove()},f=m=>{if(u(),!m||!m[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:o,value:m});for(let x=0,T=i;x<m.length;x++){let j=t.cloneNode(!0),bt=Object.assign({},e,{[c]:m[x],[l]:x});lt.add(j),T.after(j),g(j,bt),T=T.nextSibling}};queueMicrotask(()=>f(d(s))),p(s)&&s.subscribe({next:f}),n()}};var mt={select:t=>Object.keys(t.dataset).some(e=>e.startsWith("on.")),run:(t,e)=>{for(let n in t.dataset)if(n.startsWith("on.")){let r=t.dataset[n];t.removeAttribute(n),t.addEventListener(n.split(".")[1],b(e,r))}}};var ft=new WeakSet,pt={select:t=>t.matches($),run:(t,e,n)=>{let r=t.dataset.component??t.dataset.view??t.dataset.page;if(ft.has(t)||!t.parentNode)return;ft.add(t);let a=async()=>{if(!L.has(r))return q("::component/"+r,a);t.removeAttribute("data-lazy"),t.classList.add("--loading"),await L.get(r)(t,e),t.classList.remove("--loading"),t.className||t.removeAttribute("class")};t.hasAttribute("data-lazy")?(S.add(t),N(t).then(a)):W(t).then(a),n()}};var dt={select:t=>Object.keys(t.dataset).some(e=>e.startsWith("class.")),run:(t,e)=>{if(!t.parentNode)return;let n=(r,a)=>{r?t.classList.add(a):(t.classList.remove(a),t.className||t.removeAttribute("class"))};for(let r of t.getAttributeNames())if(r.startsWith("data-class.")){let a=r.split(".")[1],o=t.getAttribute(r);t.removeAttribute(r),w(o,e,c=>n(c,a),!1)}}};var Q=[ut,pt,rt,nt,ct,mt,dt,st,at,it];var ht={},M=new WeakMap;function $t(t,e={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let r=document.querySelector('head meta[name="template-path"]');return ht[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(r?.content?.replaceAll("[name]",t.toString())??t).then(o=>o.text()),document.body.append(n),a(n)}),ht[t].then(a=>g(a.content.cloneNode(!0),e))}return g(n.content.cloneNode(!0),e)}function Ft(t,e={}){let n=document.createElement("template");return n.innerHTML=t,g(n.content.cloneNode(!0),e)}function g(t,e={}){M.set(t,e);let n=(r,a=new WeakSet)=>{let o=!1;if(!a.has(r)){if(r instanceof HTMLElement||r instanceof SVGElement){for(let c of Q)c.select(r)&&c.run(r,e,()=>o=!0);if((r.parentNode||!r.dataset.for)&&gt(r,e),o)return}else if(r instanceof Text&&r.textContent.includes("{{")){let c=r.textContent.split(/{{|}}/g);for(let l=0,s=r,i;l<c.length;l++)i=document.createTextNode(c[l]),l%2!=0&&w(`{{${c[l]}}}`,e,u=>i.data=u),a.add(i),s.after(i),s=i;r.remove()}a.add(r);for(let c of r.childNodes)n(c,a)}};return n(t,new WeakSet),t}var gt=(t,e)=>{let n=t.getAttributeNames();for(let r of n){let a=t.getAttribute(r);a?.includes("{{")&&w(a,e,o=>{o=o.replace(/ +/," ").trim(),o==="undefined"||o==="null"?t.removeAttribute(r):t.setAttribute(r,o)})}},w=(t,e,n,r=!0)=>{let a=t.match(/{{[^}]+}}/g)?.map(U)??[],o=t;!r&&!a.length&&(a=[{prop:t,meta:{}}]);let c=()=>{t=o;for(let l of a)t=t.replace(l.text,d(l.value));return t};for(let l of a){let s=null;if(l.prop?.[l.prop.length-1]===")"){let i=l.prop.split("("),u=b(e,i[1].substring(0,i[1].length-1).trim()),f=i[0].trim();s=b(e,f),s=s(),s.provide(d(u),l.meta),p(u)&&u.subscribe({next:m=>s.provide(d(m),l.meta)})}else s=b(e,l.prop);if(s==null&&!Object.keys(l.meta).length&&console.warn(`{{ ${l.prop} }}: No value for this key`,{key:l.prop,value:s}),p(s)){let i=s;for(let u in l.meta)if(A[u]){let f=A[u];i=i.map(m=>f({value:m,key:l.prop,param:l.meta[u],options:l.meta}))}l.value=i,i.subscribe({next:u=>n(r?c():u)}),!r&&s.update(d(s))}else{let i=s;for(let u in l.meta)if(A[u]){let f=A[u];i=f({value:d(s),key:l.prop,param:l.meta[u],options:l.meta})}l.value=()=>i,!r&&n(i)}}r&&n(c())};var Ht=t=>{let e=document.head.querySelector(`link[rel="preload"][href="${t.href}"]`)??document.createElement("link");Object.assign(e,t),e.rel="preload",document.head.append(e)};for(let t in B)globalThis[t]=B[t];})();
