(()=>{var ft=Object.create;var z=Object.defineProperty;var mt=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var pt=Object.getPrototypeOf,ht=Object.prototype.hasOwnProperty;var gt=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var bt=(t,e)=>{for(var n in e)z(t,n,{get:e[n],enumerable:!0})},xt=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of dt(e))!ht.call(t,a)&&a!==n&&z(t,a,{get:()=>e[a],enumerable:!(r=mt(e,a))||r.enumerable});return t};var yt=(t,e,n)=>(n=t!=null?ft(pt(t)):{},xt(e||!t||!t.__esModule?z(n,"default",{value:t,enumerable:!0}):n,t));var M={};bt(M,{component:()=>Mt,deletePropsOf:()=>wt,effect:()=>U,emit:()=>Wt,executeNodeAttributesTemplate:()=>C,expression:()=>T,f:()=>d,hasProp:()=>B,hasProps:()=>j,isSignal:()=>m,memo:()=>St,off:()=>jt,on:()=>zt,once:()=>Tt,pipes:()=>v,plugins:()=>R,prop:()=>p,propsOf:()=>S,resource:()=>$,resourceBy:()=>At,setPropsOf:()=>A,signal:()=>h,templateByName:()=>Ot,templateByNode:()=>g,templateByString:()=>Ct});function T(t){let e=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let r of e)if(r[1].includes("=")){let a=r[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=r[1];return n}var v={};var k=new WeakMap,S=t=>k.get(t),wt=t=>k.delete(t),j=t=>k.has(t),A=(t,e)=>{let n=S(t);n&&typeof n=="object"?k.set(t,Object.assign(n,e)):k.set(t,e)},d=t=>typeof t=="function"?d(t()):t;function p(t,e){let n=e.split(".");if(!e)return t;for(let r of n){if(["state"].includes(r)&&t?.state)return t[r];if(m(t)){let a=t()?.[r];if(m(a)){let o=new AbortController,s=h(a());a.subscribe({next:s},{signal:o.signal});let i=l=>{o.abort(),m(l[r])?(o=new AbortController,l[r].subscribe({next:s},{signal:o.signal}),s(l[r]())):s(l[r])};t.subscribe({next:i}),t=s}else t=t.map(o=>o&&o[r])}else if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")typeof t[r]=="function"&&!m(t[r])?t=t[r].bind(t):t=t[r];else return}return t}function B(t,e){let n=e.split(".");if(!e)return!1;for(let r of n){if(["loading","error"].includes(r)&&t?.loading&&t?.error)return t[r];if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")t=t[r];else return!1}return!0}var H={items:new Map,setItem(t,e){this.items.set(t,e.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},L=new Map;function vt(t){try{let e=window[t+"Storage"];return typeof e.length=="number"?e:H}catch{return H}}window.addEventListener("storage",t=>{if(!L.has(t.key))return;let e=L.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&e.update(JSON.parse(n))});function h(t=null,e={}){if(e.id&&L.has(e.id))return L.get(e.id);let n=[],r=e.storage&&vt(e.storage),a=l=>{t=l,r&&r.setItem(e.id,JSON.stringify(t));for(let c of n)c.next(t)};function o(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let s=(l,c=null)=>{n.push(l),c?.signal.addEventListener("abort",()=>{let u=n.indexOf(l);u>-1&&n.splice(u,1)},{once:!0})};if(r){let l=r.getItem(e.id);a(typeof l=="string"&&l!=="undefined"?JSON.parse(l):t)}let i=Object.assign(o,{id:e.id,storage:e.storage,toString:()=>t.toString(),set:l=>t=l,update:a,subscribe:s,map:l=>{let c=h(l(t)),u=new AbortController,w=c.subscribe;return s({next:f=>c(l(f))},{signal:u.signal}),Object.assign(c,{set:()=>null,subscribe:(f,y)=>{w(f,y),y?.signal.addEventListener("abort",()=>u.abort())}})},filter:l=>{let c=h(l(t)?t:null);return s({next:u=>l(u)?c(u):null}),Object.assign(c,{set:()=>null})}});return e.id&&L.set(e.id,i),i}function U(t,e=[],n=null){for(let r of e)r.subscribe({next:()=>n=t(n)});return t(n)}function St(t,e=[],n=null){let r=h(null);return r(U(a=>r(t(a)),e,n)),r}function $(t,e=null){let n=h(e),r=h("loaded"),a=async()=>{if(r()!="pending"){try{r("pending"),n(await t()),r("loaded"),delete n.error}catch(o){r("error"),n.error=o}return n()}};return a(),Object.assign(n,{state:r,refetch:a})}function At(t,e,n=null){let r=$(()=>e(d(t)),n);return m(t)&&t.subscribe({next:()=>r.refetch()}),r}var m=t=>t&&t.subscribe;var kt=h({}),N=h(location.pathname);var b=document.querySelector('head meta[name="route"]');b||(b=document.createElement("meta"),b.name="route",b.content=location.pathname,document.head.append(b));var E=()=>{b.content="",N(location.pathname),kt(Object.fromEntries(new URLSearchParams(location.search))),b.content=b.content||location.pathname};window.addEventListener("popstate",E);window.addEventListener("hashchange",E);var Lt=window.history.pushState,Nt=window.history.replaceState;window.history.pushState=function(e,n,r){Lt.call(window.history,e,n,r),E()};window.history.replaceState=function(e,n,r){Nt.call(window.history,e,n,r),E()};var I=new WeakMap,Pt=new MutationObserver(t=>{for(let e of t)I.has(e.target)&&I.get(e.target)()}),F={select:"[data-match]",run:t=>{let e=t.dataset.match,n=o=>o.replace(/index\.*[a-z0-9]*$/gm,"");function r(){return n(new URL(t.dataset.route||t.getAttribute("href"),location.href).pathname)}let a=()=>{r()==n(location.pathname)?t.classList.add(e):t.classList.remove(e)};N.subscribe({next:a}),I.set(t,a),Pt.observe(t,{attributes:!0,attributeFilter:["href","data-route"]}),a(),t.removeAttribute("data-match")}};var V={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},J={select:"[data-bind],[name]",run:(t,e)=>{let n=t.dataset.bind||t.getAttribute("name"),r=p(e,n);if(r){let a=o=>{t.type=="checkbox"?t.checked=o:t.value=o};a(d(r)),m(r)&&(r.subscribe({next:a}),t.addEventListener("input",()=>r(V[t.type]?.(t)??t.value)),t.addEventListener("change",()=>r(V[t.type]?.(t)??t.value)))}}};var P=new WeakMap,D=new IntersectionObserver(t=>{for(let e of t)if(e.isIntersecting&&P.has(e.target)){for(let n of P.get(e.target))n();P.delete(e.target),D.unobserve(e.target)}},{rootMargin:"256px"});function x(t){return new Promise(e=>{let n=P.get(t)??[];n.push(e),P.set(t,n),D.observe(t)})}var O=new WeakSet,K={select:"[data-include]",run:(t,e)=>{if(O.has(t)||t.children.length)return;O.add(t);let n=t.hasAttribute("data-lazy")&&t.closest("[hidden]"),r=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0}));let a=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(a.ok){let o=await a.text();t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),t.innerHTML=o;for(let s of t.childNodes)g(s,e);t.removeAttribute("data-include"),t.removeAttribute("data-lazy")}};t.hasAttribute("data-lazy")?x(t).then(r):r()}};var G=new WeakSet,Q={select:"[data-for]",run:(t,e,n)=>{if(G.has(t))return;let r=t.dataset.for.replace("let","").split("of"),a=r[0].split(","),o=r.at(-1).trim(),s=a[0].trim()==o?"__e":a[0].trim(),i=a[1]?.trim()??"__i",l=p(e,o),c=document.createComment(t.dataset.for);t.replaceWith(c),O.add(t);let u=()=>{let f=c;for(;(f=f.nextSibling)&&(f instanceof HTMLElement&&f.dataset.for==t.dataset.for);)f=f.previousSibling,f.nextSibling.remove()},w=f=>{if(u(),!f||!f[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:o,value:f});for(let y=0,W=c;y<f.length;y++){let q=t.cloneNode(!0),ut=Object.assign({},e,{[s]:f[y],[i]:y});G.add(q),W.after(g(q,ut)),W=W.nextSibling}};w(d(l)),m(l)&&l.subscribe({next:w}),n()}};var X={select:"[data-if]",run:(t,e)=>{let n=p(e,t.dataset.if),r=document.createComment("if: "+t.dataset.if);t.replaceWith(r);let a=o=>{!t.parentNode&&o?(t.hidden=!1,r.after(t)):t.localName!="link"&&t.remove()};a(d(n)),m(n)&&n.subscribe({next:a})}};var Y=new WeakSet,Z={select:"[data-lazy]",run:(t,e,n)=>{if(Y.has(t)||!t.childNodes.length)return;Y.add(t);let r=t.dataset.lazy,a=()=>{t.removeAttribute("data-lazy"),C(t,e);for(let o of t.childNodes)g(o,e)};r&&(t.addEventListener("::load",()=>t.classList.add(r),{once:!0}),t.addEventListener("::loaded",()=>t.classList.remove(r),{once:!0})),x(t).then(a),n()}};var tt={select:"[data-on]",run:(t,e)=>{let n=r=>{let a=r.split(":"),o=a[0].trim(),s=a.at(-1).trim(),i=p(e,s);i&&t.addEventListener(o,i)};for(let r of t.dataset.on.split(","))n(r)}};var et=t=>{let e=document.createElement("link");Object.assign(e,t),e.rel="preload",document.head.append(e)};var rt=new WeakSet,nt={select:"[data-preload]",run:t=>{if(rt.has(t)||t.hidden)return;rt.add(t);let e=()=>{let n=t.dataset.preload.split(",");for(let r of n){let a=r.split(":");et({href:a[0],as:a[1]??"fetch"})}};t.hasAttribute("data-lazy")?x(t).then(e):e()}};var Et=t=>{let e=t.dataset.route||t.dataset.routeNot;if(e[0]=="/")return e;for(;t=t.parentElement;){let n=t.dataset.route||t.dataset.routeNot;n&&(e=n.replaceAll("*","")+e)}return e.replaceAll(/\/+|\/\*\//g,"/")},at=[],ot=()=>{let t=location.href.replace(/index\.*[a-z0-9]*$/gm,"");for(let e of at){let n=e.pattern.test(t);if(e.negate?!n:n){if(e.node.hidden=!1,e.node.parentNode)continue;e.placeholder.after(e.node);let r=document.querySelector('head meta[name="route"]');r&&(r.content=e.pattern.pathname)}else e.node.localName!="link"&&e.node.remove()}};N.subscribe({next:ot});var st={select:"[data-route], [data-route-not]",run:async t=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let e=Et(t),n=new URLPattern({pathname:e}),r=document.createComment("route: "+e);t.replaceWith(r),at.push({node:t,pattern:n,placeholder:r,negate:t.hasAttribute("data-route-not")}),ot()}};var R=[Q,X,st,nt,K,tt,J,F,Z];var it={},_={};function Ot(t,e={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let r=document.querySelector('head meta[name="template-path"]');return it[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(r?.content?.replaceAll("[name]",t.toString())??t).then(i=>i.text());let o=n.content.querySelectorAll('link[rel="stylesheet"][href]'),s=[];for(let i of o)_[i.href]??=fetch(i.href,{headers:{accept:"text/css"}}).then(l=>l.text()),_[i.href].then(l=>{let c=document.createElement("style");c.innerHTML=l,i.replaceWith(c)}),s.push(_[i.href]);await Promise.all(s),document.body.append(n),a(n)}),it[t].then(a=>g(a.content.cloneNode(!0),e))}return g(n.content.cloneNode(!0),e)}function Ct(t,e={}){let n=document.createElement("template");return n.dataset.name="anonymous",n.innerHTML=t,g(n.content.cloneNode(!0),e)}function g(t,e={}){let n=(r,a=new WeakSet)=>{let o=!1;if(!(j(r)||a.has(r))){if(r.nodeName=="#document-fragment"&&A(r,e),r instanceof HTMLElement){A(r,e);for(let s of R)r.matches(s.select)&&s.run(r,e,()=>o=!0);if(o)return;C(r,e)}else if(r instanceof Text&&r.textContent.includes("{{")){let s=r.textContent.split(/{{|}}/g);for(let i=0,l=r,c;i<s.length;i++)c=document.createTextNode(s[i]),i%2!=0&&lt(`{{${s[i]}}}`,e,u=>c.data=u.replaceAll("<null>","")),a.add(c),l.after(c),l=c;r.remove()}a.add(r);for(let s of r.childNodes)n(s,a)}};return n(t,new WeakSet),t}var C=(t,e)=>{let n=t.getAttributeNames();for(let r of n){let a=t.getAttribute(r);a?.includes("{{")?lt(a,e,o=>{o=o.trim().replace(/ +/," "),o==="<null>"?t.removeAttribute(r):t.setAttribute(r,o)}):t.localName.includes("-")&&B(e,a)&&t.setAttribute(r,`@parent.${a}`)}},lt=(t,e,n)=>{let r=t.match(/{{[^}]+}}/g).map(T),a=t,o=()=>{t=a;for(let s of r){let i=d(s.value);t=t.replace(s.text,i??"<null>")}return t};for(let s of r){let i=p(e,s.prop);if(i==null&&console.warn(`{{ ${s.prop} }}: No value for this key`,{key:s.prop,value:i}),m(i)){let l=i;for(let c in s.meta)if(v[c]){let u=v[c];l=l.map(w=>u({value:w,key:s.prop,param:s.meta[c],options:s.meta}))}s.value=l,l.subscribe({next:()=>n(o())})}else{let l=i;for(let c in s.meta)if(v[c]){let u=v[c];l=u({value:d(i),key:s.prop,param:s.meta[c],options:s.meta})}s.value=()=>l}}n(o())};function Mt(t,e,n){customElements.define(t,class extends HTMLElement{static observedAttributes=Object.keys(e).map(r=>r.toLowerCase());#t=Object.fromEntries(Object.entries(e).map(r=>[r[0],h(r[1])]));#e={};#r=!1;#n=null;on(r,a,o=null){this.addEventListener(r,a,o)}emit(r,a=null,o=!1){this.dispatchEvent(new CustomEvent(r,{detail:a,bubbles:o}))}async connectedCallback(){if(this.#n??=this.hasAttribute("data-lazy"),this.#n&&!this.#r)this.#r=!0,this.emit("::load",null,!0),this.removeAttribute("data-lazy"),await x(this);else{if(this.#r)return this.emit("::mount");await Promise.resolve(),this.emit("::load",null,!0),this.#r=!0}let r=this.shadowRoot??this.attachShadow({mode:"open"}),a=n(this.#t,this);(s=>{if(A(this,S(s)),"querySelector"in s){let i=s.querySelector("slot");if(i)for(;i.firstChild;)this.append(i.firstChild)}r.append(s),this.emit("::loaded",null,!0);for(let i in e){let l=this.getAttribute(i)??"";this.hasAttribute(i)||this.setAttribute(i,e[i]?.toString()),l.startsWith("@parent.")||(this.#e[i]??=new AbortController,this.#t[i].subscribe({next:c=>c==null?this.removeAttribute(i):this.setAttribute(i,c.toString())},{signal:this.#e[i].signal}))}this.dispatchEvent(new CustomEvent("::mount"))})(a instanceof Promise?await a:a)}disconnectedCallback(){this.dispatchEvent(new CustomEvent("::unmount"))}#a(r=""){r=r.toLowerCase();for(let a in this.#t)if(a.toLowerCase()==r)return[e[a],this.#t[a]];return[null,null]}attributeChangedCallback(r,a,o){let[s,i]=this.#a(r);if(o?.startsWith("@parent.")){let l=this.parentNode.host||this.parentNode,c=o.slice(8),u=p(S(l),c)??p(S(this),c);m(u)?(this.#e[r]?.abort(),this.#e[r]=new AbortController,this.#t[r]=u):i(u)}else i(typeof s=="number"?parseFloat(o):o)}})}var ct=new WeakMap;function Wt(t,e=null){document.dispatchEvent(new CustomEvent(t,{detail:e}))}function zt(t,e){let n=r=>e(r.detail);ct.set(e,n),document.addEventListener(t,n)}function Tt(t){return new Promise(e=>{let n=r=>e(r.detail);document.addEventListener(t,n,{once:!0})})}function jt(t,e){document.removeEventListener(t,ct.get(e))}for(let t in M)globalThis[t]=M[t];})();
