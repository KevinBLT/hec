(()=>{var it=Object.create;var W=Object.defineProperty;var lt=Object.getOwnPropertyDescriptor;var ct=Object.getOwnPropertyNames;var ut=Object.getPrototypeOf,ft=Object.prototype.hasOwnProperty;var mt=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var dt=(t,e)=>{for(var n in e)W(t,n,{get:e[n],enumerable:!0})},pt=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ct(e))!ft.call(t,a)&&a!==n&&W(t,a,{get:()=>e[a],enumerable:!(r=lt(e,a))||r.enumerable});return t};var ht=(t,e,n)=>(n=t!=null?it(ut(t)):{},pt(e||!t||!t.__esModule?W(n,"default",{value:t,enumerable:!0}):n,t));var M={};dt(M,{component:()=>Pt,deletePropsOf:()=>z,effect:()=>_,emit:()=>At,expression:()=>j,f:()=>d,hasProp:()=>B,hasProps:()=>T,isSignal:()=>m,memo:()=>gt,off:()=>Ot,on:()=>Nt,once:()=>Ct,pipes:()=>v,plugins:()=>R,prop:()=>h,propsOf:()=>S,resource:()=>U,resourceBy:()=>xt,setPropsOf:()=>E,signal:()=>b,templateByName:()=>kt,templateByNode:()=>x,templateByString:()=>Lt});function j(t){let e=t.matchAll(/([^ {}\s]+)/g),n={meta:{},text:t,prop:null};for(let r of e)if(r[1].includes("=")){let a=r[1].split("=");n.meta[a[0]]=a[1].replaceAll(/'|"/g,"")}else n.prop=r[1];return n}var v={};var L=new WeakMap,S=t=>L.get(t),z=t=>L.delete(t),T=t=>L.has(t),E=(t,e)=>{let n=S(t);n&&typeof n=="object"?L.set(t,Object.assign(n,e)):L.set(t,e)},d=t=>typeof t=="function"?d(t()):t;function h(t,e){let n=e.split(".");if(!e)return t;for(let r of n){if(["loading","error"].includes(r)&&t?.loading&&t?.error)return t[r];if(m(t)){let a=t()?.[r];if(m(a)){let o=new AbortController,l=b(a());a.subscribe({next:l},{signal:o.signal});let c=s=>{o.abort(),m(s[r])?(o=new AbortController,s[r].subscribe({next:l},{signal:o.signal}),l(s[r]())):l(s[r])};t.subscribe({next:c}),t=l}else t=t.map(o=>o&&o[r])}else if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")typeof t[r]=="function"&&!m(t[r])?t=t[r].bind(t):t=t[r];else return}return t}function B(t,e){let n=e.split(".");if(!e)return!1;for(let r of n){if(["loading","error"].includes(r)&&t?.loading&&t?.error)return t[r];if(typeof t=="function")t=d(t);else if(typeof t[r]<"u")t=t[r];else return!1}return!0}var H={items:new Map,setItem(t,e){this.items.set(t,e.toString())},get length(){return this.items.keys().length},key(t){return Array.from(this.items.values()).at(t)},clear(){this.items.clear()},getItem(t){return this.items.get(t)},removeItem(t){this.items.delete(t)}},P=new Map;function bt(t){try{let e=window[t+"Storage"];return typeof e.length=="number"?e:H}catch{return H}}window.addEventListener("storage",t=>{if(!P.has(t.key))return;let e=P.get(t.key),n=t.storageArea.getItem(t.key);typeof n=="string"&&n!=="undefined"&&e.update(JSON.parse(n))});function b(t=null,e={}){if(e.id&&P.has(e.id))return P.get(e.id);let n=[],r=e.storage&&bt(e.storage),a=s=>{t=s,r&&r.setItem(e.id,JSON.stringify(t));for(let i of n)i.next(t)};function o(){return arguments.length&&t!==arguments[0]&&a(arguments[0]),t}let l=(s,i=null)=>{n.push(s),i?.signal.addEventListener("abort",()=>{let u=n.indexOf(s);u>-1&&n.splice(u,1)},{once:!0})};if(r){let s=r.getItem(e.id);a(typeof s=="string"&&s!=="undefined"?JSON.parse(s):t)}let c=Object.assign(o,{id:e.id,storage:e.storage,toString:()=>t.toString(),set:s=>t=s,update:a,subscribe:l,map:s=>{let i=b(s(t)),u=new AbortController,p=i.subscribe;return l({next:f=>i(s(f))},{signal:u.signal}),Object.assign(i,{set:()=>null,subscribe:(f,g)=>{p(f,g),g?.signal.addEventListener("abort",()=>u.abort())}})},filter:s=>{let i=b(s(t)?t:null);return l({next:u=>s(u)?i(u):null}),Object.assign(i,{set:()=>null})}});return e.id&&P.set(e.id,c),c}function _(t,e=[],n=null){for(let r of e)r.subscribe({next:()=>n=t(n)});return t(n)}function gt(t,e=[],n=null){let r=b(null);return r(_(a=>r(t(a)),e,n)),r}function U(t,e=null){let n=b(e),r=b(!0),a=b(null),o=async()=>{try{n(await t()),r(!1)}catch(l){l(l)}return n()};return o(),Object.assign(n,{loading:r,error:a,refetch:o})}function xt(t,e,n=null){let r=U(()=>e(d(t)),n);return m(t)&&t.subscribe({next:()=>r.refetch()}),r}var m=t=>t&&t.subscribe;var yt=b({}),A=b(location.pathname);var y=document.querySelector('head meta[name="route"]');y||(y=document.createElement("meta"),y.name="route",y.content=location.pathname,document.head.append(y));var C=()=>{y.content="",A(location.pathname),yt(Object.fromEntries(new URLSearchParams(location.search))),y.content=y.content||location.pathname};window.addEventListener("popstate",C);window.addEventListener("hashchange",C);var wt=window.history.pushState,vt=window.history.replaceState;window.history.pushState=function(e,n,r){wt.call(window.history,e,n,r),C()};window.history.replaceState=function(e,n,r){vt.call(window.history,e,n,r),C()};var I=new WeakMap,St=new MutationObserver(t=>{for(let e of t)I.has(e.target)&&I.get(e.target)()}),$={select:"[data-match]",run:t=>{let e=t.dataset.match,n=o=>o.replace(/index\.*[a-z0-9]*$/gm,"");function r(){return n(new URL(t.dataset.route||t.getAttribute("href"),location.href).pathname)}let a=()=>{r()==n(location.pathname)?t.classList.add(e):t.classList.remove(e)};A.subscribe({next:a}),I.set(t,a),St.observe(t,{attributes:!0,attributeFilter:["href","data-route"]}),a(),t.removeAttribute("data-match")}};var F={number:t=>t.valueAsNumber,date:t=>t.valueAsDate,text:t=>t.value,checkbox:t=>t.checked,"":t=>t.value},V={select:"[data-bind],[name]",run:(t,e)=>{let n=t.getAttribute("name")||t.dataset.bind,r=h(e,n);if(r){let a=o=>{t.type=="checkbox"?t.checked=o:t.value=o};a(d(r)),m(r)&&(r.subscribe({next:a}),t.addEventListener("input",()=>r(F[t.type]?.(t)??t.value)),t.addEventListener("change",()=>r(F[t.type]?.(t)??t.value)))}}};var N=new WeakMap,J=new IntersectionObserver(t=>{for(let e of t)if(e.isIntersecting&&N.has(e.target)){for(let n of N.get(e.target))n();N.delete(e.target),J.unobserve(e.target)}},{rootMargin:"256px"});function w(t){return new Promise(e=>{let n=N.get(t)??[];n.push(e),N.set(t,n),J.observe(t)})}var O=new WeakSet,D={select:"[data-include]",run:(t,e)=>{if(O.has(t)||t.children.length)return;O.add(t);let n=t.hasAttribute("data-lazy")&&t.closest("[hidden]"),r=async()=>{t.dispatchEvent(new CustomEvent("::load",{bubbles:!0}));let a=await fetch(t.dataset.include,{headers:{accept:"text/html,text/*"}});if(a.ok){let o=await a.text();t.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),t.innerHTML=o;for(let l of t.childNodes)x(l,e);t.removeAttribute("data-include"),t.removeAttribute("data-lazy")}};t.hasAttribute("data-lazy")?w(t).then(r):r()}};var K=new WeakSet,G={select:"[data-for]",run:(t,e,n)=>{if(K.has(t))return;let r=t.dataset.for.replace("let","").split("of"),a=r[0].split(","),o=r.at(-1).trim(),l=a[0].trim()==o?"__e":a[0].trim(),c=a[1]?.trim()??"__i",s=h(e,o),i=document.createComment(t.dataset.for);t.replaceWith(i),O.add(t);let u=()=>{let f=i;for(;(f=f.nextSibling)&&(f instanceof HTMLElement&&f.dataset.for==t.dataset.for);)f=f.previousSibling,f.nextSibling.remove()},p=f=>{if(u(),!f||!f[Symbol.iterator])return console.warn("data-for: The value given is not iterable.",{key:o,value:f});for(let g=0,k=i;g<f.length;g++){let q=t.cloneNode(!0),ot=Object.assign({},e,{[l]:f[g],[c]:g});K.add(q),k.after(x(q,ot)),k=k.nextSibling}};p(d(s)),m(s)&&s.subscribe({next:p}),n()}};var Q={select:"[data-if]",run:(t,e)=>{let n=h(e,t.dataset.if),r=document.createComment("if: "+t.dataset.if);t.replaceWith(r);let a=o=>{!t.parentNode&&o?(t.hidden=!1,r.after(t)):t.localName!="link"&&t.remove()};a(d(n)),m(n)&&n.subscribe({next:a})}};var X=new WeakSet,Y={select:"[data-lazy]",run:(t,e,n)=>{if(X.has(t)||!t.childNodes.length)return;X.add(t);let r=t.dataset.lazy,a=()=>{x(t,e);for(let o of t.childNodes)x(o,e);t.removeAttribute("data-lazy")};r&&(t.addEventListener("::load",()=>t.classList.add(r),{once:!0}),t.addEventListener("::loaded",()=>t.classList.remove(r),{once:!0})),w(t).then(a),n()}};var Z={select:"[data-on]",run:(t,e)=>{let n=r=>{let a=r.split(":"),o=a[0].trim(),l=a.at(-1).trim(),c=h(e,l);c&&t.addEventListener(o,c)};for(let r of t.dataset.on.split(","))n(r)}};var tt=t=>{let e=document.createElement("link");Object.assign(e,t),e.rel="preload",document.head.append(e)};var et=new WeakSet,rt={select:"[data-preload]",run:t=>{if(et.has(t)||t.hidden)return;et.add(t);let e=()=>{let n=t.dataset.preload.split(",");for(let r of n){let a=r.split(":");tt({href:a[0],as:a[1]??"fetch"})}};t.hasAttribute("data-lazy")?w(t).then(e):e()}};var Et=t=>{let e=t.dataset.route;for(;t=t.parentElement;)t.dataset.route&&(e=t.dataset.route+e);return e.replaceAll(/\/+/g,"/")},nt={select:"[data-route]",run:async t=>{"URLPattern"in window||await import("https://kevinblt.github.io/hec/packages/@hec.js/ui/dist/urlpattnern.min.js");let e=Et(t),n=new URLPattern({pathname:e}),r=document.createComment("route: "+e);t.replaceWith(r);let a=()=>{let o=location.href.replace(/index\.*[a-z0-9]*$/gm,"");if(!t.parentNode&&n.test(o)){t.hidden=!1,r.after(t);let l=document.querySelector('head meta[name="route"]');l&&(l.content=n.pathname)}else t.localName!="link"&&t.remove()};A.subscribe({next:a}),a()}};var R=[G,Q,nt,rt,D,Z,V,$,Y];var at={};function kt(t,e={}){t instanceof URL&&(t=t.host==location.host?t.pathname:t.toString());let n=document.querySelector(`template[name="${t}"]`);if(!n){let r=document.querySelector('head meta[name="template-path"]');return at[t]??=new Promise(async a=>{n=document.createElement("template"),n.setAttribute("id",t.toString()),n.innerHTML=await fetch(r?.content?.replaceAll("[name]",t.toString())??t).then(c=>c.text());let o=n.content.querySelectorAll('link[rel="stylesheet"][href]'),l=[];for(let c of o)l.push(fetch(c.href).then(s=>s.text()).then(s=>{let i=document.createElement("style");i.innerHTML=s,c.replaceWith(i)}));await Promise.all(l),document.body.append(n),a(n)}),at[t].then(a=>x(a.content.cloneNode(!0),e))}return x(n.content.cloneNode(!0),e)}function Lt(t,e={}){let n=document.createElement("template");return n.dataset.name="anonymous",n.innerHTML=t,x(n.content.cloneNode(!0),e)}function x(t,e={}){let n=(a,o)=>{let l=a.match(/{{[^}]+}}/g).map(j),c=a,s=()=>{a=c;for(let i of l){let u=d(i.value);a=a.replace(i.text,u??"<null>")}return a};for(let i of l){let u=h(e,i.prop);if(u==null&&console.warn(`{{ ${i.prop} }}: No value for this key`,{key:i.prop,value:u}),m(u)){let p=u;for(let f in i.meta)if(v[f]){let g=v[f];p=p.map(k=>g({value:k,key:i.prop,param:i.meta[f],options:i.meta}))}i.value=p,p.subscribe({next:()=>o(s())})}else{let p=u;for(let f in i.meta)if(v[f]){let g=v[f];p=g({value:d(u),key:i.prop,param:i.meta[f],options:i.meta})}i.value=()=>p}}o(s())},r=(a,o=new WeakSet)=>{let l=!1;if(!(T(a)||o.has(a))){if(a.nodeName=="#document-fragment"&&E(a,e),a instanceof HTMLElement){let c=a.getAttributeNames();E(a,e);for(let s of R)a.matches(s.select)&&s.run(a,e,()=>l=!0);if(l)return;for(let s of c){let i=a.getAttribute(s);i?.includes("{{")?n(i,u=>{u=u.trim().replace(/ +/," "),u==="<null>"?a.removeAttribute(s):a.setAttribute(s,u)}):a.localName.includes("-")&&B(e,i)&&a.setAttribute(s,`@parent.${i}`)}}else if(a instanceof Text&&a.textContent.includes("{{")){let c=a.textContent.split(/{{|}}/g);for(let s=0,i=a,u;s<c.length;s++)u=document.createTextNode(c[s]),s%2!=0&&n(`{{${c[s]}}}`,p=>u.data=p.replaceAll("<null>","")),o.add(u),i.after(u),i=u;a.remove()}o.add(a);for(let c of a.childNodes)r(c,o)}};return r(t,new WeakSet),t}function Pt(t,e,n){customElements.define(t,class extends HTMLElement{static observedAttributes=Object.keys(e).map(r=>r.toLowerCase());#e=Object.fromEntries(Object.entries(e).map(r=>[r[0],b(r[1])]));#t={};#r=!1;on(r,a,o=null){this.addEventListener(r,a,o)}querySelector(r){return this.shadowRoot.querySelector(r)}querySelectorAll(r){return this.shadowRoot.querySelectorAll(r)}async connectedCallback(){if(this.hasAttribute("data-lazy")&&await w(this),this.dispatchEvent(new CustomEvent("::load",{bubbles:!0})),this.#r){this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),this.dispatchEvent(new CustomEvent("::mount"));return}let r=this.shadowRoot??this.attachShadow({mode:"open"}),a=n(this.#e,this);(l=>{E(this,S(l)),this.dispatchEvent(new CustomEvent("::loaded",{bubbles:!0})),r.append(l),this.#r=!0,this.#t["::attributes"]=new AbortController;for(let c in e)this.hasAttribute(c)||this.setAttribute(c,e[c].toString()),this.#e[c].subscribe({next:s=>this.setAttribute(c,s.toString())},{signal:this.#t["::attributes"].signal});this.dispatchEvent(new CustomEvent("::mount"))})(a instanceof Promise?await a:a)}disconnectedCallback(){z(this);for(let r in this.#t)this.#t[r].abort(),delete this.#t[r];this.dispatchEvent(new CustomEvent("::unmount"))}#n(r=""){r=r.toLowerCase();for(let a in this.#e)if(a.toLowerCase()==r)return[e[a],this.#e[a]];return[null,null]}attributeChangedCallback(r,a,o){let[l,c]=this.#n(r);if(o.startsWith("@parent.")){let s=this.parentNode.host||this.parentNode,i=o.slice(8),u=h(S(s),i)??h(S(this),i);m(u)?(this.#t[l]?.abort(),this.#t[l]=new AbortController,c(d(u)),u.subscribe({next:c},{signal:this.#t[l].signal})):c(u)}else c(typeof l=="number"?parseFloat(o):o)}})}var st=new WeakMap;function At(t,e=null){document.dispatchEvent(new CustomEvent(t,{detail:e}))}function Nt(t,e){let n=r=>e(r.detail);st.set(e,n),document.addEventListener(t,n)}function Ct(t){return new Promise(e=>{let n=r=>e(r.detail);document.addEventListener(t,n,{once:!0})})}function Ot(t,e){document.removeEventListener(t,st.get(e))}for(let t in M)globalThis[t]=M[t];})();
